(this["webpackJsonptls-investment-advisor"]=this["webpackJsonptls-investment-advisor"]||[]).push([[0],{132:function(e,t,n){var a=n(242),i=["prepare","preprocess","process","clean"];e.exports=function(){var e=new Worker(n.p+"0289f8e37f8b057cf80f.worker.js",{name:"[hash].worker.js"});return a(e,i),e}},164:function(e,t,n){},165:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(29),s=n.n(r),o=(n(164),n(26)),c=n(36),l=n.n(c),u=n(53),d=(n(165),n(25)),m=n(23),h=n(249),v=n(251),p=n(248),f=n(252),b=n(98),j=n(99),g=n(246),O=n(48),x=n(107),y=[{name:"Bank of Stineford",price:4e5,profits:24e4},{name:"Stineford Weapons Store",price:2e5,profits:75e3},{name:"Trading Pillar Rights",price:3e5,profits:1e5},{name:"Stineford Succubus Tower",price:function(e){return e.chapter1x2Tower?8e5:1e6},social:2},{name:"Yhilini Airship Fleet",price:1e6,profits:1e5},{name:"Min's Trade Route",price:4e5,profits:185e3,givini:1,chalice:1},{name:"Yhilini Succubi Trade",price:function(e){return e.chapter3Infrastructure?4e5:55e4},profits:2e5,chalice:2},{name:"Yhilini Brothel Reform",price:25e3,profits:35e3},{name:"Premium Steel Owner",price:function(e){return e.chapter1Steel?75e3:1e5},profits:1e4},{name:"Yhilini Bank Core Lender",price:function(e){return e.chapter1Bank?45e4:5e5},profits:15e4},{name:"Mercenary Offices",price:function(e){return e.chapter3Infrastructure?15e4:25e4},profits:15e3,social:2},{name:"Theltiar Rentals",price:425e3,profits:95e3,social:1},{name:"Theltiar Flowhouse",price:25e4,profits:8e4},{name:"Denmiel Mushrooms",price:105e3,profits:4e4},{name:"Denmiel Archives",price:function(e){return"full_unlock"===e.gawnfallMother?15e4:25e4},profits:2e4,social:1},{name:"Eustrin Guild",price:6e5,profits:25e4},{name:"Succubus Armorer",price:function(e){return e.chapter3Armorer?1e5:15e4},profits:1e4,chalice:2},{name:"Gasm Falls Trade",price:275e3,profits:11e4,chalice:2},{name:"Givini Tunnels",price:15e5,profits:3e5,givini:3,takkan:3,chalice:3},{name:"Lustlord Temples",price:function(e){return e.lustlordStatuesBought?75e4:8e5},profits:5e4,chalice:function(e){return e.lustlordStatuesBought?5:7}},{name:"Succubus Band Tour",price:1e5,profits:2e3,givini:2,social:1,takkan:2},{name:"Gasm Falls Water Cleanup",price:25e4,social:1,chalice:5},{name:"Gasm Falls Orc Tunnels",price:2e5,social:1,chalice:5},{name:"Givini Smithing",price:2e5,profits:1e4,givini:2},{name:"Givini Orc Merchant",price:function(e){var t=e.giviniStart,n=void 0===t?0:t;return n<20?1e5:n<25?2e5:n<35?3e5:n<45?4e5:5e5},profits:function(e){var t=e.giviniStart,n=void 0===t?0:t,a=e.giviniExtra,i=n+(void 0===a?0:a)+e.investments.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.givini)||0)}),0);return i<20?25e3:i<30?5e4:i<40?1e5:i<50?15e4:2e5},givini:5},{name:"Givini Teahouse Chain",price:275e3,profits:3e4,givini:2,social:1,takkan:1,chalice:1},{name:"Bank of Givini",price:35e4,profits:3e5,givini:5,takkan:2,chalice:2},{name:"Givini Mage Guild",price:1e6,profits:4e4,givini:5},{name:"War Monument",price:1e6,givini:10,social:3,takkan:2,chalice:2},{name:"Tarran'Kan Housing + Tarran'Kan Trade Upgrade",price:function(e){var t=e.gawnfallTakkan;return"major"===t?85e4:"minor"===t?1e6:11e5},profits:1e5,social:1,takkan:7},{name:"Hall of Mental Strength",price:2e5,profits:25e3,social:1,takkan:3},{name:"Booze Shack",price:15e4,profits:5e4,social:1,takkan:2},{name:"Tradesmasher's Guild",price:35e4,profits:function(e){var t=e.investments,n=void 0===t?[]:t,a=e.previousInvestments,i=void 0===a?[]:a,r=e.gawnfallTakkan,s=(e.chapter3Tradesmasher?1:0)+[].concat(Object(m.a)(i),Object(m.a)(n.map((function(e){return e.name})))).filter((function(e){return["Cee'Kan Shipping","Lonely Sailor Services","Givini Orc Merchant","Orcish Democracy","Orc Pools Upgrade"].includes(e)})).length+("major"===r?1:0);return s<1?25e3:1===s?5e4:2===s?75e3:3===s?125e3:4===s?15e4:5===s?175e3:2e5},takkan:5},{name:"Lonely Sailor Services",price:25e4,profits:1e5,social:1,takkan:5},{name:"Cee'Kan Shipping",price:7e5,profits:2e5,takkan:5},{name:"Orcish Democracy",price:1e6,social:5,takkan:10},{name:"Imp Offices",price:1e5,social:1,takkan:1},{name:"Orc Pools Upgrade",price:5e5,social:2,takkan:5},{name:"Givini Banners + Givini Dragon Statue",price:3500,givini:1},{name:"Orcish Drake Statue + Orcish Gargoyle Statue + Orcish Golden Drake Statue",price:8e3,takkan:1},{name:"Aram Eustrin Embassy",price:function(e){return e.eustrinEmbassy||1/0}}],S=function(e){var t=e.gawnfallArdford;return"resolved"===t||"overkill"===t},k=function(e){return function(t){return S(t)&&e||1/0}},w=[].concat(y,[{name:"Tak'Kan Mine",price:function(e){var t=e.gawnfallTakkan;return"major"===t?25e4:"minor"===t?5e5:1/0},profits:125e3,social:1,takkan:5},{name:"Ivalan Bank",price:k(55e4),profits:225e3},{name:"Mercenary Flotilla",price:k(5e5),profits:25e3},{name:"Sanitation Mages Guild",price:k(1e5),profits:5e3},{name:"Crystal Refiner",price:k(4e5),profits:55e3},{name:"Ardford Restaurant",price:k(1e5),profits:function(e){var t=e.investments,n=e.previousInvestments,a=void 0===n?[]:n;return S(e)&&[].concat(Object(m.a)(a),Object(m.a)(t.map((function(e){return e.name})))).includes("Givini Teahouse Chain")?25e3:1e4}}]),I=y,T=n(3),C=function(e){var t,n=e.name,i=e.label,r=e.tooltip,s=e.purchased,o=e.form,c=e.list;return Object(a.useEffect)((function(){o.setFieldsValue(Object(x.a)({},n,o.getFieldValue(n).filter((function(e){return!s.includes(e)}))))}),[o,s,n]),Object(T.jsx)(v.a.Item,{label:i,name:n,tooltip:r,children:Object(T.jsx)(b.a,{options:(t=c,"gawnfall"===t?w:y).filter((function(e){var t=e.name;return!s.includes(t)})).sort((function(e,t){var n=e.name,a=t.name;return n.localeCompare(a)})).map((function(e){var t=e.name;return{label:t,value:t}})),mode:"multiple"})})},G=function(e){var t=e.purchased,n=e.form,a=e.list,i=e.tooltip;return Object(T.jsx)(C,{form:n,purchased:t,label:"Investments you explicitly refuse to buy, for any reason",name:"banned",tooltip:i,list:a})},M=function(e){var t=e.form,n=e.purchased,a=e.tooltip,i=e.label,r=e.list;return Object(T.jsx)(C,{name:"mandatory",form:t,purchased:n,label:i||"Investments you explicitly want to buy, for any reason",tooltip:a,list:r})},N=function(e){var t=e.tooltip;return Object(T.jsx)(v.a.Item,{label:"Other spending",name:"spending",tooltip:t,children:Object(T.jsx)(f.a,{})})},R=h.a.Title,P=["New Givini Trade","Tak'Kan Trade","Chalice States Trade","Min's Trade Route","Yhilini Succubi Trade","Yhilini Bank Core Lender","Mercenary Offices","Theltiar Rentals","Theltiar Flowhouse","Denmiel Mushrooms","Denmiel Archives","Eustrin Guild","Gasm Falls Trade","Premium Steel Owner","Ivalan Bank","Mercenary Flotilla","Sanitation Mages Guild","Crystal Refiner","Ardford Restaurant"],A={previous:["Premium Steel Owner","New Givini Trade","Tak'Kan Trade","Chalice States Trade","Min's Trade Route","Yhilini Succubi Trade","Eustrin Guild","Denmiel Mushrooms","Ivalan Bank","Crystal Refiner","Ardford Restaurant"],remainingPron:7500,baseProfit:2435e3,chapter1Steel:!1,strategy:"compromise",startingSocial:34,chapter3Infrastructure:!0,merchantSolution:"wait",jhenno:"religion",magicalItems:"givini",mandatory:["Givini Orc Merchant","Bank of Givini","Bank of Stineford"],research:"orc",banned:["Orcish Drake Statue + Orcish Gargoyle Statue + Orcish Golden Drake Statue"],spending:0,chapter1Bank:!0,chapter1x2Tower:!0,chapter3Armorer:!0,chapter3Tradesmasher:!0,trades:["givini","takkan","chalice"],eustrinEmbassy:3e5},F={required:!0,message:"Please provide a value."},B=function(e){var t,n=e.onFinish,i=e.loading,r=v.a.useForm(),s=Object(o.a)(r,1)[0],c=Object(a.useState)(A.previous),l=Object(o.a)(c,2),u=l[0],d=l[1],h=Object(a.useState)(A.mandatory),x=Object(o.a)(h,2),y=x[0],S=x[1],k=Object(a.useState)(A.strategy),w=Object(o.a)(k,2),I=w[0],C=w[1];return Object(a.useEffect)((function(){["social","succession"].includes(I)?"wait"===s.getFieldValue("merchantSolution")&&s.setFieldsValue({merchantSolution:"neutral"}):"neutral"===s.getFieldValue("merchantSolution")&&s.setFieldsValue({merchantSolution:"wait"})}),[s,I]),Object(T.jsxs)(v.a,{initialValues:A,onFinish:n,onValuesChange:function(e,t){d(t.previous),S(t.mandatory),C(t.strategy)},className:"round-form first-round-form",form:s,children:[Object(T.jsxs)("div",{className:"past-block",children:[Object(T.jsx)(R,{level:2,children:"Chapters 1-3"}),Object(T.jsxs)(p.a,{children:[Object(T.jsxs)("div",{className:"numbers",children:[Object(T.jsx)(v.a.Item,{label:"ProN remaining at the end of chapter 3",name:"remainingPron",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "ProN available".',rules:[F],children:Object(T.jsx)(f.a,{})}),Object(T.jsx)(v.a.Item,{label:"Total profit at the start of chapter 4",name:"baseProfit",tooltip:'In the Calculator, go to "First Tower Run and Investment and copy the value next to "Total ProN Return".',rules:[F],children:Object(T.jsx)(f.a,{})}),Object(T.jsx)(v.a.Item,{label:"Social standing at the start of chapter 4",name:"startingSocial",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "Social Score".',rules:[F],children:Object(T.jsx)(f.a,{})}),Object(T.jsx)(v.a.Item,{label:"Price of the Aram Eustrin Embassy",name:"eustrinEmbassy",tooltip:'In the Calculator, search for "Aram\'s Eustrin Embassy" and copy-paste the given prince here.',rules:[F],children:Object(T.jsx)(f.a,{})})]}),Object(T.jsx)(v.a.Item,{label:"Investments already bought during chapters 2/3",name:"previous",children:Object(T.jsx)(b.a,{options:(t=P,Object(m.a)(t).sort().map((function(e){return{label:e,value:e}}))),mode:"multiple"})}),Object(T.jsxs)("div",{className:"checkboxes",children:[Object(T.jsx)(v.a.Item,{name:"chapter1x2Tower",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You visited the Stineford Succubus Tower during chapter 1/2."})}),!u.includes("Premium Steel Owner")&&Object(T.jsx)(v.a.Item,{name:"chapter1Steel",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You invested 20,000 ProN in Premium Steel during chapter 1."})}),!u.includes("Yhilini Bank Core Lender")&&Object(T.jsx)(v.a.Item,{name:"chapter1Bank",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You invested in the Yhilin Bank during chapter 1."})}),!(u.includes("Yhilini Succubi Trade")&&u.includes("Mercenary Offices"))&&Object(T.jsx)(v.a.Item,{name:"chapter3Infrastructure",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You funded Yhilin Infrastructure during chapter 3."})}),Object(T.jsx)(v.a.Item,{name:"chapter3Armorer",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You visited the Succubus Armorer during chapter 3."})}),Object(T.jsx)(v.a.Item,{name:"chapter3Tradesmasher",valuePropName:"checked",children:Object(T.jsx)(j.a,{children:"You met Tradesmasher during chapter 3."})})]})]})]}),Object(T.jsx)(R,{level:2,children:"Chapter 4 \u2013 Round 1"}),Object(T.jsxs)(p.a,{title:"Strategy",children:[Object(T.jsx)(v.a.Item,{name:"strategy",label:"Succession crisis",children:Object(T.jsx)(b.a,{options:[{label:"Focus on profits; do only the bare minimum for the Ardan succession crisis (New Givini \u2265 25).",value:"money"},{label:"Reach most thresholds for the Ardan succession crisis while keeping a focus on profits (New Givini \u2265 25, Social \u2265 30).",value:"compromise"},{label:"Mix profits and social to achieve almost everything in the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40).",value:"social"},{label:"Go all in on the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40, War Monument or Givini Mage Guild).",value:"succession"}]})}),Object(T.jsx)("div",{className:"selects",children:Object(T.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution",children:Object(T.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})})}),Object(T.jsxs)("div",{className:"selects",children:[Object(T.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(T.jsx)(b.a,{options:[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}]})}),Object(T.jsx)(v.a.Item,{label:"Jhenno's cooperation",name:"jhenno",children:Object(T.jsx)(b.a,{options:[{value:"politics",label:"Politics"},{value:"religion",label:"Religion"}]})}),Object(T.jsx)(v.a.Item,{label:"Rose's house magical items",name:"magicalItems",children:Object(T.jsx)(b.a,{options:[{value:"chalice",label:"Chalice States"},{value:"givini",label:"Givini"},{value:"takkan",label:"Tak'Kan"}]})})]}),Object(T.jsx)(g.a,{}),Object(T.jsx)(M,{purchased:u,form:s,tooltip:"Forcing a few certain investments can improve performances tremendously."}),Object(T.jsx)(G,{purchased:[].concat(Object(m.a)(u),Object(m.a)(y)),form:s,tooltip:Object(T.jsxs)(T.Fragment,{children:["For cases where a particular investment might be more of a curse than a blessing in the long run and you want to see what happens without it.",Object(T.jsx)("br",{}),"Banning an investment that you know to be useless at that particular point can also improve performances quite a bit, especially if said investment is cheap."]})}),Object(T.jsx)(N,{tooltip:"Money to be spent on investments not listed elsewhere, like headquarters upgrades."}),Object(T.jsx)(v.a.Item,{children:Object(T.jsx)(O.a,{type:"primary",htmlType:"submit",loading:i,children:"Submit"})})]})]})},E=n(133),K=n(247),D=function(e){var t=e.initialStandings,n=e.investmentChanges,a=e.nonInvestmentChanges,i={};return["profits","givini","social","takkan","chalice"].forEach((function(e){i[e]=t[e]+(n[e]||0)+(a[e]||0)})),i.investments=[].concat(Object(m.a)(t.investments),Object(m.a)(n.investments.map((function(e){return e.name})))),i.money=t.money+t.profits-n.price+a.money,i},L=function(e){return e.toLocaleString("en-US")},V=120,W=function(e){var t=e.children,n=e.format?L(Math.abs(t)):Math.abs(t);return"".concat(t<0?"-":"+").concat(n)},U=function(e){var t=e.investments.map((function(e){var t=e.name,n=Object(E.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),n=[{title:"Name",dataIndex:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Price",dataIndex:"price",render:function(e){return L(e)},sorter:function(e,t){return e.price-t.price},width:V},{title:"Profits",dataIndex:"profits",render:function(e){return L(e)},sorter:function(e,t){return e.profits-t.profits},width:V},{title:"Social",dataIndex:"social",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(T.jsx)(W,{children:e})},width:V}];return Object(T.jsx)(K.a,{dataSource:t,columns:n,pagination:!1})},Y=function(e){var t=e.list,n=(void 0===t?[]:t).map((function(e){var t=e.name,n=Object(E.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(T.jsx)(W,{format:!0,children:e})},i=[{title:"Name",dataIndex:"name"},{title:"ProN",dataIndex:"money",render:a,width:V},{title:"Profits",dataIndex:"profits",render:a,width:V},{title:"Social",dataIndex:"social",render:a,width:V}];return Object(T.jsx)(K.a,{dataSource:n,columns:i,pagination:!1})},q=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,i=function(e,t){var n=t.key;return["base","total"].includes(n)?L(e):Object(T.jsx)(W,{format:!0,children:e})},r=[{dataIndex:"category"},{title:"ProN",dataIndex:"money",render:i,width:V},{title:"Profits",dataIndex:"profits",render:i,width:V},{title:"Social",dataIndex:"social",render:i,width:V}],s=function(e){return t[e]+n[e]+a[e]},o=a.profits-a.investments.reduce((function(e,t){return e+t.profits}),0),c=[Object(d.a)(Object(d.a)({},t),{},{key:"base",category:"Previously"}),{key:"previous_investments",category:"Start of the round",money:t.profits,profits:0,social:0},Object(d.a)(Object(d.a)({},a),{},{key:"investments",category:"Changes from new investments",money:-a.price,profits:a.profits-o}),Object(d.a)(Object(d.a)({},n),{},{key:"other",category:"Other changes",profits:n.profits+o})],l=o>0?[].concat(Object(m.a)(n.list),[{name:"Extra profits from past investments",profits:o}]):n.list;return Object(T.jsx)(K.a,{dataSource:c,columns:r,pagination:!1,bordered:!0,expandable:{expandedRowRender:function(e){var t=e.key;return"investments"===t?Object(T.jsx)(U,{investments:a.investments}):"other"===t?Object(T.jsx)(Y,{list:l}):null},rowExpandable:function(e){var t,a=e.key;return"investments"===a||!("other"!==a||!(null===(t=n.list)||void 0===t?void 0:t.length))},defaultExpandAllRows:!0},summary:function(){return Object(T.jsxs)(K.a.Summary.Row,{children:[Object(T.jsx)(K.a.Summary.Cell,{colSpan:2,children:"Standings at the end of the round"}),Object(T.jsx)(K.a.Summary.Cell,{children:L(t.money+t.profits+n.money-a.price)}),Object(T.jsx)(K.a.Summary.Cell,{children:L(s("profits"))}),Object(T.jsx)(K.a.Summary.Cell,{children:s("social")})]})},className:"ledger"})},H=function(e){var t=e.startingValue,n=void 0===t?0:t,a=e.dataSources;return Object(T.jsxs)("table",{className:"addition",children:[Object(T.jsx)("tbody",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:"Initial value"}),Object(T.jsx)("td",{children:n}),Object(T.jsx)("td",{})]})}),a.filter((function(e){return e.dataSource.length>0})).map((function(e,t){var n=e.title,a=e.dataSource;return Object(T.jsxs)("tbody",{children:[Object(T.jsx)("tr",{children:Object(T.jsx)("th",{colSpan:"3",scope:"col",children:n})}),a.map((function(e,t){var n=e.label,a=e.values,i=e.explanation;return Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:n}),Object(T.jsx)("td",{children:a.map((function(e){return"+".concat(e)})).join(" ")}),Object(T.jsx)("td",{children:i})]},t.toString())}))]},t.toString())})),Object(T.jsx)("tfoot",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{scope:"row",children:"Total"}),Object(T.jsx)("td",{children:n+a.reduce((function(e,t){return e+t.dataSource.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}))}),0)}),0)})]})})]})},_=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},J=function(e){var t=e.investments;return[{label:"Petitions",values:[5,5,2,2,2]},t.includes("New Givini Trade")&&{label:"New Givini Trade",values:[5],explanation:"On purchase"},t.includes("Min's Trade Route")&&{label:"Min's Trade Route",values:[1]}].filter(Boolean)},z=function(e){var t=e.chapter3Investments;return-5+_(J({investments:t}))},Q=function(e,t){var n=e.merchantSolution;return["givini"===e.magicalItems&&{label:"House Rose's magical items: Givini",values:[2]},"neutral"===n&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===n&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"Givino Vinai equipment shop girl",values:[1]},{label:"Givini king",values:[1]},t.includes("New Givini Trade")&&{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},X=function(){return _(Q.apply(void 0,arguments))},Z=function(e,t){var n=e.merchantSolution2;return["neutral"===n&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===n&&{label:"Merchant dispute: Favor New Givini",values:[2]},t.includes("New Givini Trade")&&{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},$=function(){return _(Z.apply(void 0,arguments))},ee=function(e,t){var n=e.merchantSolution3,a=e.gawnfallTakkan,i=e.gawnfallMercantile;return["neutral"===n&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===n&&{label:"Merchant dispute: Favor New Givini",values:[2]},"major"===a&&{label:"Gawnfall: Tak'Kan vote",values:[1]},["excellent","good"].includes(i)&&{label:"Gawnfall: Mercantile solution",values:[1]},t.includes("New Givini Trade")&&{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},te=function(){return _(ee.apply(void 0,arguments))},ne=function(e){var t=e.chapter3Investments,n=void 0===t?[]:t,a=e.roundOneInvestments,i=void 0===a?[]:a,r=e.decisions,s=void 0===r?{}:r;return Object(T.jsx)(H,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:J({investments:n})},{title:"Investments",dataSource:i.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:Q(s,n)}]})},ae=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},ie=function(e){return[{label:"Petitions",values:[5,2,2,5]},e.includes("Tak'Kan Trade")&&{label:"Tak'Kan Trade",values:[5],explanation:"On purchase"}].filter(Boolean)},re=function(){return-5+ae(ie.apply(void 0,arguments))},se=function(e,t){var n=e.magicalItems,a=e.research;return["takkan"===n&&{label:"House Rose's magical items: Tak'Kan",values:[2]},t.includes("Tak'Kan Trade")&&{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===a&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},oe=function(){return ae(se.apply(void 0,arguments))},ce=function(e,t){var n=e.research;return[t.includes("Tak'Kan Trade")&&{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===n&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},le=function(){return ae(ce.apply(void 0,arguments))},ue=function(e,t){var n=e.research,a=e.gawnfallMercantile,i=e.gawnfallTakkan;return["minor"===i&&{label:"Gawnfall: Tak'Kan vote",values:[2]},"major"===i&&{label:"Gawnfall: Tak'Kan vote",values:[5]},["excellent","good"].includes(a)&&{label:"Gawnfall: Mercantile solution",values:[1]},t.includes("Tak'Kan Trade")&&{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===n&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},de=function(){return ae(ue.apply(void 0,arguments))},me=function(e){var t=e.roundOneInvestments,n=void 0===t?[]:t,a=e.decisions,i=void 0===a?{}:a,r=e.chapter3Investments,s=void 0===r?[]:r;return Object(T.jsx)(H,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:ie(s)},{title:"Investments",dataSource:n.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:se(i,s)}]})},he=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},ve=function(e){var t=e.initialInvestments;return[{label:"Petitions",values:[5,5,1,5,2,2]},t.includes("Chalice States Trade")&&{label:"Chalice States Trade",values:[5],explanation:"On purchase"},t.includes("Min's Trade Route")&&{label:"Min's Trade Route",values:[1]},t.includes("Gasm Falls Shop")&&{label:"Gasm Falls Shop",values:[2]},t.includes("Yhilini Succubi Trade")&&{label:"Yhilini Succubi Trade",values:[2]}].filter(Boolean)},pe=function(e){var t=e.initialInvestments;return 10+he(ve({initialInvestments:t}))},fe=function(e,t){return["chalice"===e.magicalItems&&{label:"House Rose's magical items: Chalice States",values:[2]},t.includes("Chalice States Trade")&&{label:"Chalice States Trade",values:[1],explanation:"At the end of the round"}].filter(Boolean)},be=function(){return he(fe.apply(void 0,arguments))},je=function(e,t){return[t.includes("Chalice States Trade")&&{label:"Chalice States Trade",values:[1],explanation:"At the end of the round"}].filter(Boolean)},ge=function(){return he(je.apply(void 0,arguments))},Oe=function(e,t){var n=e.gawnfallMercantile,a=e.gawnfallTakkan;return[e.lustlordStatuesBought&&{label:"New Lustlord Statues",values:[2]},"major"===a&&{label:"Gawnfall: Tak'Kan vote",values:[2]},["excellent","good"].includes(n)&&{label:"Gawnfall: Mercantile solution",values:[1]},t.includes("Chalice States Trade")&&{label:"Chalice States Trade",values:[1],explanation:"At the end of the round"}].filter(Boolean)},xe=function(){return he(Oe.apply(void 0,arguments))},ye=function(e){var t=e.chapter3Investments,n=void 0===t?[]:t,a=e.roundOneInvestments,i=void 0===a?[]:a,r=e.decisions,s=void 0===r?{}:r;return Object(T.jsx)(H,{startingValue:10,dataSources:[{title:"Chapter start",dataSource:ve({initialInvestments:n})},{title:"Investments",dataSource:i.filter((function(e){var t=e.chalice;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.chalice]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:fe(s,n)}]})},Se=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,i=e.decisions;return Object(T.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(T.jsx)(q,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(T.jsxs)("div",{children:[Object(T.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(T.jsx)(ne,{chapter3Investments:t.investments,roundOneInvestments:a.investments,decisions:i})}),Object(T.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(T.jsx)(me,{chapter3Investments:t.investments,roundOneInvestments:a.investments,decisions:i})}),Object(T.jsx)(p.a,{title:"Chalice States",type:"inner",children:Object(T.jsx)(ye,{chapter3Investments:t.investments,roundOneInvestments:a.investments,decisions:i})})]})]})},ke=function(e){var t=e.children,n=e.data,i=Object(a.useRef)(null);return Object(a.useEffect)((function(){n&&i.current&&i.current.scrollIntoView({behavior:"smooth"})}),[n,i]),n?Object(T.jsx)("div",{ref:i,children:t}):null},we=function(e,t){var n=t.strategy,a=t.jhenno,i=t.merchantSolution;return"money"===n?0:"neutral"===i?40-e:("compromise"===n?30:40)-(e+("politics"===a?1:0))},Ie=function(e){var t=e.decisions,n=e.spending,a=e.initialStandings,i=a.investments.filter((function(e){return["New Givini Trade","Tak'Kan Trade","Chalice States Trade"].includes(e)})),r=["politics"===t.jhenno&&{name:"Jhenno's political cooperation",social:1},{name:"Succession crisis' reward (best result)",social:3},i.length>0&&{name:"The Trades become less profitable",profits:-1e5*i.length},!!n&&{name:"Other spending",money:-n}].filter(Boolean);return{givini:X(t,a.investments),takkan:oe(t,a.investments),chalice:be(t,a.investments),money:r.reduce((function(e,t){var n=t.money;return e+(void 0===n?0:n)}),0),profits:r.reduce((function(e,t){var n=t.profits;return e+(void 0===n?0:n)}),0),social:r.reduce((function(e,t){var n=t.social;return e+(void 0===n?0:n)}),0),list:r}},Te=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,i,r,s,o,c,u,m,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.runInWoker,a=t.initialStandings,i=t.decisions,r=t.nonInvestmentChanges,s=t.mandatory,o=t.misc,c=t.banned,u=a.givini,m=r.givini,h=Object(d.a)(Object(d.a)({},o),{},{previousInvestments:a.investments,money:a.money+a.profits+r.money,otherRequirements:{social:we(a.social,i),givini:(l={giviniStart:u,giviniExtra:m},25-l.giviniStart-l.giviniExtra+3),mandatory:s,atLeastOne:"succession"===i.strategy?["War Monument","Givini Mage Guild"]:void 0,banned:c},giviniStart:u,giviniExtra:m}),e.abrupt("return",n(h));case 5:case"end":return e.stop()}var l}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,i,r,s,o,c,u,m,h,v,p,f,b,j,g,O,x,y,S,k,w,I,T,C,G,M,N,R,P;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,a=t.setResult,i=t.runInWoker,(r=t.setError)(void 0),s=n.previous,o=void 0===s?[]:s,c=n.remainingPron,u=n.baseProfit,m=n.startingSocial,h=n.strategy,v=n.merchantSolution,p=n.jhenno,f=n.magicalItems,b=n.research,j=n.mandatory,g=n.banned,O=n.spending,x=n.chapter1Steel,y=n.chapter3Infrastructure,S=n.chapter1Bank,k=n.chapter1x2Tower,w=n.chapter3Armorer,I=n.chapter3Tradesmasher,T=n.eustrinEmbassy,C={money:c,profits:u,investments:o,social:m,givini:z({chapter3Investments:o}),takkan:re(o),chalice:pe({initialInvestments:o})},M={chapter1Steel:x,chapter3Infrastructure:y,chapter1Bank:S,chapter1x2Tower:k,chapter3Armorer:w,chapter3Tradesmasher:I,eustrinEmbassy:T},N=Ie({decisions:G={strategy:h,merchantSolution:v,magicalItems:f,research:b,jhenno:p},spending:O,initialStandings:C}),e.next=9,Te({runInWoker:i,initialStandings:C,decisions:G,nonInvestmentChanges:N,mandatory:j,misc:M,banned:g});case 9:if(R=e.sent){e.next=14;break}return a(void 0),r("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 14:P=Object(d.a)(Object(d.a)({},R),{},{money:-R.price}),a({initialStandings:C,decisions:G,nonInvestmentChanges:N,investmentChanges:P,finalStandings:D({initialStandings:C,nonInvestmentChanges:N,investmentChanges:P}),misc:M}),r(void 0);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(e){var t=e.runInWoker,n=e.loading,a=e.result,i=e.setResult,r=e.setError;return Object(T.jsxs)("div",{className:"round-one",children:[Object(T.jsx)(B,{onFinish:function(e){Ce({values:e,setResult:i,runInWoker:t,setError:r})},loading:n}),Object(T.jsx)(ke,{data:a,children:Object(T.jsx)(Se,Object(d.a)({},a))})]})},Me=n(132),Ne=n.n(Me),Re=n(256),Pe=h.a.Title,Ae=function(){return Object(T.jsxs)("div",{className:"disclaimer",children:[Object(T.jsxs)("div",{className:"preamble",children:[Object(T.jsx)(Pe,{children:"Investment Advisor"}),Object(T.jsxs)("p",{children:["A tool to help you choose the best theoretical best possible investments for chapter 4 of ",Object(T.jsx)("a",{href:"https://the-last-sovereign.blogspot.com/",children:"The Last Sovereign"}),"."]}),Object(T.jsx)("p",{children:"Just fill in the requested information, choose your strategy and let a quasi-brute force algorithm determine what's best for you (assuming a definition of best here as highest short term returns, then lowest price, while still fulfilling the requirements of your strategy)."}),Object(T.jsxs)("p",{children:["This is definetely an advanced tool, intended for people who are already familiar with the game's ",Object(T.jsx)("a",{href:"https://thelastsovereign.miraheze.org/wiki/Secret_stats",children:"inner workings"}),", with the awesome ",Object(T.jsx)("a",{href:"https://thelastsovereign.flarum.cloud/d/15-calculator",children:"Calculator"}),", and are now looking for the last lousy optimizations they might have missed."]})]}),Object(T.jsx)(Re.a,{message:"Assumptions",description:Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("p",{children:Object(T.jsx)("a",{href:"https://www.patreon.com/posts/demographics-8851324",children:"About 85% of players have only ever played TLS with Reshaped Varia."})}),Object(T.jsx)("p",{children:'That means if I was to write a walkthrough for TLS that only covered a "Reshaped Varia" strategy, it\'ll still be usable by 85% of players. Of course, I will have to release a "Dominated Varia" variant eventually to account for the remaining 15%. But in the meantime, that\'s already 85% of people that can start playing with my walkthrough without waiting any further. Meanwhile, if I had tried to cover both cases from the start, 100% of people would have had to wait.'}),Object(T.jsx)("p",{children:'While I\'m writing a software and not a walkthrough here, it will play by the same logic: Focus first on the "general case", by making a few (many) assumptions that hopefully will be true of most "good" saves, so to be able to release it to the public early. Then slowly cover the other cases in subsequent updates.'}),Object(T.jsx)("p",{children:"Therefore, at the moment, this tool takes for granted that:"}),Object(T.jsxs)("ol",{children:[Object(T.jsx)("li",{children:"The Iron Cudgel was hired (in either chapter 1 or 2)."}),Object(T.jsx)("li",{children:"Through chapter 2, the AriGarda was bribed, the Merchant's Guild joined, and the Ardan Bank invested into."}),Object(T.jsx)("li",{children:"Chapter 3 in general was good enough for Yhilin to reach its final state during the first investment phase of Chapter 4."}),Object(T.jsx)("li",{children:"Chapter 3 in general and the war in particular were good enough for all petitions favorable to New Givini, Tak'Kan and the Chalice States to appear."}),Object(T.jsx)("li",{children:"All such petitions were approved."})]}),Object(T.jsx)("p",{children:'Note that the final version of the advisor will likely still have a few assumptions in it, so as to keep the complexity in check. Namely, "disaster runs" will never be covered.'}),Object(T.jsx)("p",{children:"tl;dr The Advisor is currently in early access."})]}),type:"info",showIcon:!0,className:"assumptions",closable:!0})]})},Fe=n(254),Be=n(253),Ee=n(250),Ke=function(e){var t=e.combinationsCount,n=e.progress,a=e.investmentsCount,i=e.preprogress,r=e.abort;return a?Object(T.jsxs)(Fe.a,{visible:!0,centered:!0,closable:!1,footer:null,children:[Object(T.jsxs)("div",{children:[Object(T.jsxs)("p",{children:["Prefiltering ".concat(Math.pow(2,a).toLocaleString("en-US")," (2"),Object(T.jsx)("sup",{children:a}),") possibilities\u2026"]}),Object(T.jsx)(Be.a,{percent:Math.round(100*i)})]}),!!t&&Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(g.a,{}),Object(T.jsxs)("div",{children:[Object(T.jsx)("p",{children:"Processing ".concat(t.toLocaleString("en-US")," remaining possibilities\u2026")}),Object(T.jsx)(Be.a,{percent:Math.round(1e4*n)/100})]})]}),Object(T.jsx)(O.a,{danger:!0,icon:Object(T.jsx)(Ee.a,{}),onClick:r,className:"abort-button",children:"Abort"})]}):null},De=n(255),Le=function(e){var t=e.message;return Object(T.jsx)(p.a,{children:Object(T.jsx)(De.a,{status:"warning",title:t})})},Ve=[{key:"Tower Little Girl talk",magic:1,military:0,price:0},{key:"Deluxe Givini Dragon Statue",magic:1,military:0,price:5e3},{key:"HQ Shrine",magic:1,military:0,price:5e3},{key:"Orc Lab Upgrade",magic:2,military:5,price:25e3},{key:"Magical Shielding Upgrade",magic:5,military:0,price:1e5}],We=[{key:"Research: Base Defense",military:5,magic:10,price:0}],Ue=[{key:"Wynn's Shield Upgrade",magic:5,military:0,price:1e5},{key:"Extradimensional Foundation",magic:5,military:5,price:225e3}],Ye=[{key:"Armory Upgrade",military:5,magic:0,price:1e4},{key:"Orc Guard Posts",military:3,magic:0,price:5e3},{key:"Supplies Upgrade",military:2,magic:0,price:1e4}],qe=[{key:"Armory Upgrade",military:5,magic:0,price:1e4},{key:"Orc Guard Posts",military:3,magic:0,price:5e3},{key:"Second Well",military:3,magic:0,price:1e4},{key:"Iron Cudgel",military:4,magic:0,price:15e3}],He=function(e){return"+".concat(e)},_e=[{title:"Upgrade",dataIndex:"key"},{title:"Price",dataIndex:"price",render:function(e){return L(e)},sorter:function(e,t){return e.price-t.price}},{title:"Military",dataIndex:"military",render:He,sorter:function(e,t){return e.military-t.military}},{title:"Magic",dataIndex:"magic",render:He,sorter:function(e,t){return e.magic-t.magic}}],Je=function(e){var t=e.research,n=e.military,a=e.magic;if("defense"===t){if(n<=10&&20===a)return[].concat(We,Ve);if(20===n&&a<=10)return[].concat(We,qe);if(20===n&&20===a)return[].concat(We,Ve,Ye)}if(n<=10&&20===a)return[].concat(Ve,Ue);if(20===n&&a<=10)return[].concat(Ve,qe);if(20===n&&20===a)return[].concat(Ve,Ue,Ye);throw new Error("Unsupported")},ze=function(e,t){return e.reduce((function(e,n){return e+n[t]}),0)},Qe=function(e){return ze(Je(e),"price")},Xe=function(e){var t=e.research,n=e.military,a=e.magic,i=Je({research:t,military:n,magic:a});return Object(T.jsx)("div",{className:"headquarters-upgrades",children:Object(T.jsx)(K.a,{dataSource:i,columns:_e,pagination:!1,summary:function(){return Object(T.jsxs)(K.a.Summary.Row,{children:[Object(T.jsx)(K.a.Summary.Cell,{children:"Total"}),Object(T.jsx)(K.a.Summary.Cell,{children:L(ze(i,"price"))}),Object(T.jsx)(K.a.Summary.Cell,{children:ze(i,"military")}),Object(T.jsx)(K.a.Summary.Cell,{children:ze(i,"magic")})]})}})})},Ze={merchantSolution2:"neutral",headquarters:"20/10",orcCouncil:.8,mandatory:["Yhilini Airship Fleet"],banned:[],spending:0},$e=function(e){var t=e.onFinish,n=e.loading,i=e.firstRoundDecisions,r=e.purchasedInvestments,s=v.a.useForm(),c=Object(o.a)(s,1)[0],l=Object(a.useState)(Ze.headquarters),u=Object(o.a)(l,2),d=u[0],h=u[1],f=d.split("/").map((function(e){return parseInt(e)})),j=Object(o.a)(f,2),g=j[0],x=j[1],y=Object(a.useState)(Ze.mandatory),S=Object(o.a)(y,2),k=S[0],w=S[1],I=i.research;return Object(a.useEffect)((function(){c.setFieldsValue({research:"purity"===I?"orc":"purity"})}),[c,I]),Object(T.jsx)(v.a,{initialValues:Ze,onFinish:t,className:"round-form second-round-form",form:c,onValuesChange:function(e,t){h(t.headquarters),w(t.mandatory)},children:Object(T.jsxs)(p.a,{title:"Stategy",type:"inner",children:[Object(T.jsxs)("div",{className:"two-columns",children:[Object(T.jsxs)("div",{children:["wait"===i.merchantSolution&&Object(T.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution2",children:Object(T.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})}),Object(T.jsx)(v.a.Item,{name:"orcCouncil",label:"Orc council",children:Object(T.jsx)(b.a,{options:[{label:"Substantial majority (\u2265 65%)",value:.65},{label:"Overwhelming majority (\u2265 80%)",value:.8}]})}),Object(T.jsx)(v.a.Item,{name:"headquarters",label:"Headquarters",children:Object(T.jsx)(b.a,{options:[{label:"Pay ".concat(L(Qe({research:I,military:20,magic:10}))," ProN for Military \u2265 20, Magic \u2265 10."),value:"20/10"},{label:"Pay ".concat(L(Qe({research:I,military:5,magic:20}))," ProN for Military \u2265 5, Magic \u2265 20."),value:"5/20"},{label:"Pay ".concat(L(Qe({research:I,military:20,magic:20}))," ProN for Military \u2265 20, Magic \u2265 20."),value:"20/20"}]})}),Object(T.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(T.jsx)(b.a,{options:[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}].filter((function(e){return e.value!==I}))})}),Object(T.jsx)(M,{form:c,purchased:r}),Object(T.jsx)(G,{purchased:[].concat(Object(m.a)(r),Object(m.a)(k)),form:c}),Object(T.jsx)(N,{})]}),Object(T.jsx)(Xe,{research:I,military:g,magic:x})]}),Object(T.jsx)(v.a.Item,{children:Object(T.jsx)(O.a,{type:"primary",htmlType:"submit",loading:n,children:"Submit"})})]})})},et=function(e){var t=e.initialStandings,n=e.roundTwoInvestments,a=void 0===n?[]:n,i=e.decisions,r=void 0===i?{}:i;return Object(T.jsx)(H,{startingValue:t.givini,dataSources:[{title:"Investments",dataSource:a.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:Z(r,t.investments)}]})},tt=h.a.Text,nt=function(e){var t=e.initialStandings,n=e.roundTwoInvestments,a=void 0===n?[]:n,i=e.decisions,r=void 0===i?{}:i,s=e.roundOneResearch,o=e.takkanScore,c=t.takkan,l=t.investments,u=function(e){var t=e.investments,n=void 0===t?[]:t,a=e.takkan,i=e.researches,r=5,s=2;return a>=40?r+=4:a>=30?(r+=3,s+=1):a>=20?(r+=2,s+=2):a>=10?(r+=1,s+=3):s+=4,(void 0===i?[]:i).includes("orc")?r+=1:s+=1,r+=n.filter((function(e){return["Orc Pools Upgrade","Tarran'Kan Housing + Tarran'Kan Trade Upgrade","Hall of Mental Strength","Imp Offices"].includes(e)})).length,n.includes("Orcish Democracy")&&(r=2),r/(r+s)}({researches:[s],investments:[].concat(Object(m.a)(l),Object(m.a)(a.map((function(e){return e.name})))),takkan:o});return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(H,{startingValue:c,dataSources:[{title:"Investments",dataSource:a.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:ce(r,l)}]}),Object(T.jsxs)(tt,{children:["Orc council: ",Object(T.jsxs)(tt,{type:u>=.8?"success":"warning",children:[(100*u).toFixed(2),"%"]})]})]})},at=function(e){var t=e.initialStandings,n=e.roundTwoInvestments,a=void 0===n?[]:n;e.decisions;return Object(T.jsx)(H,{startingValue:t.chalice,dataSources:[{title:"Investments",dataSource:a.filter((function(e){var t=e.chalice;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.chalice]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:je(0,t.investments)}]})},it=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,i=e.decisions,r=e.roundOneDecisions;return Object(T.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(T.jsx)(q,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(T.jsxs)("div",{children:[Object(T.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(T.jsx)(et,{initialStandings:t,roundTwoInvestments:a.investments,decisions:i})}),Object(T.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(T.jsx)(nt,{initialStandings:t,roundTwoInvestments:a.investments,decisions:i,takkanScore:t.takkan+a.takkan,roundOneResearch:r.research})}),Object(T.jsx)(p.a,{title:"Chalice States",type:"inner",children:Object(T.jsx)(at,{initialStandings:t,roundTwoInvestments:a.investments,decisions:i})})]})]})},rt=h.a.Title,st=function(e,t){return"neutral"===t.merchantSolution2&&e<40?40-e:0},ot=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,i,r,s,c,u,m,h,v,p,f,b,j,g,O,x,y,S,k,w,I,T,C,G,M;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.setResult,a=t.runInWoker,i=t.setError,r=t.firstRoundResult,s=t.values,c=r.finalStandings,u=r.misc,m=s.merchantSolution2,h=s.headquarters,v=s.orcCouncil,p=s.mandatory,f=s.banned,b=s.research,j=s.spending,O=(g={merchantSolution2:m,headquarters:h,orcCouncil:v,research:b}).headquarters.split("/").map((function(e){return parseInt(e)})),x=Object(o.a)(O,2),y=x[0],S=x[1],k=Qe({research:r.decisions.research,military:y,magic:S}),I=[{name:"Headquarters upgrades",money:-k},!!j&&{name:"Other spending",money:-j},{name:"Tower's chest ProN note",money:w=2500}].filter(Boolean),T={money:I.reduce((function(e,t){var n=t.money;return e+(void 0===n?0:n)}),0),profits:0,social:0,givini:$(g,c.investments),takkan:le(g,c.investments),chalice:ge(g,c.investments),list:I},C=Object(d.a)(Object(d.a)({},u),{},{previousInvestments:c.investments,money:c.money+c.profits+(T.money-w),giviniStart:c.givini,giviniExtra:T.givini,takkan:c.takkan,completedResearch:[r.decisions.research],otherRequirements:{social:st(c.social,g),orcCouncil:g.orcCouncil,mandatory:p,banned:f}}),e.next=12,a(C);case 12:if(G=e.sent){e.next=17;break}return n(void 0),i("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 17:M=Object(d.a)(Object(d.a)({},G),{},{money:-G.price}),n({initialStandings:c,decisions:g,nonInvestmentChanges:T,investmentChanges:M,finalStandings:D({initialStandings:c,nonInvestmentChanges:T,investmentChanges:M}),misc:u}),i(void 0);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(e){var t=e.runInWoker,n=e.loading,a=e.result,i=e.setResult,r=e.setError,s=e.firstRoundResult;return Object(T.jsxs)("div",{className:"round-two",children:[Object(T.jsx)(rt,{level:2,children:"Chapter 4 \u2013 Round 2"}),Object(T.jsx)($e,{onFinish:function(e){ot({setResult:i,runInWoker:t,setError:r,firstRoundResult:s,values:e})},loading:n,firstRoundDecisions:s.decisions,purchasedInvestments:s.finalStandings.investments}),Object(T.jsx)(ke,{data:a,children:Object(T.jsx)(it,Object(d.a)({roundOneDecisions:s.decisions},a))})]})},lt=n(120),ut={mandatory1:["Givini Tunnels"],yelarel:"min",gawnfallTakkan:"major",gawnfallMercantile:"excellent",gawnfallArdford:"resolved",gawnfallMother:"full_unlock",vera:!0,merchantSolution3:"neutral",mandatory:[],banned:[],gawnfallHigh:"herin_overwhelming",reserves:5375e3,extra_reserves:0,spending:0},dt=function(e){var t=e.previousInvestments,n=e.previousResearch,i=e.onFinish,r=e.loading,s=e.merchantSolution,c=v.a.useForm(),l=Object(o.a)(c,1)[0],u=Object(a.useState)(ut.mandatory1),d=Object(o.a)(u,2),h=d[0],j=d[1],x=Object(a.useState)(ut.mandatory),y=Object(o.a)(x,2),S=y[0],k=y[1],C=Object(a.useState)([]),R=Object(o.a)(C,2),P=R[0],A=R[1],F=[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}].filter((function(e){var t=e.value;return!n.includes(t)}));return Object(a.useEffect)((function(){l.setFieldsValue({research:F[0].value})}),[l,F]),Object(T.jsxs)(v.a,{initialValues:ut,className:"round-form third-round-form",form:l,onFinish:i,onValuesChange:function(e,n){j(n.mandatory1),k(n.mandatory),A(w.filter((function(e){var a=e.name,i=e.price;return!t.includes(a)&&("function"===typeof i&&i(n)===1/0)})).map((function(e){return e.name})))},children:[Object(T.jsx)(p.a,{title:"Gawnfall",type:"inner",className:"gawnfall",children:Object(T.jsxs)("div",{className:"two-columns",children:[Object(T.jsxs)(p.a,{title:"Strategy",type:"inner",children:[!s&&Object(T.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution3",children:Object(T.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})}),Object(T.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(T.jsx)(b.a,{options:F})}),!t.includes("Lustlord Temples")&&Object(T.jsx)(v.a.Item,{label:"Yelarel-related investments",name:"yelarel",children:Object(T.jsx)(b.a,{options:[{value:"none",label:"Don't invest in the Lustlord cult"},{value:"min",label:"Pay ".concat(L(5e4)," ProN for New Lustlord Statues")},{value:"max",label:"Invest a total of ".concat(L(8e5)," ProN in the Lustlord Temples")}]})}),Object(T.jsx)(v.a.Item,{label:"Buy the Goddess of Magic Statue for ".concat(L(1e4)," ProN?"),name:"vera",children:Object(T.jsx)(lt.a.Group,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),Object(T.jsx)(v.a.Item,{label:"Other investments you wish to do before the Council",name:"mandatory1",children:Object(T.jsx)(b.a,{options:I.filter((function(e){var n=e.name;return!t.includes(n)&&"Lustlord Temples"!==n})).map((function(e){var t=e.name;return{label:t,value:t}})),mode:"multiple"})})]}),Object(T.jsxs)(p.a,{title:"Investments-related results",type:"inner",children:[Object(T.jsx)(Re.a,{message:"Only the Succubi Accepted path is supported as of now.",type:"info",showIcon:!0}),Object(T.jsx)(v.a.Item,{label:"Support for Tak'Kan",name:"gawnfallTakkan",children:Object(T.jsx)(b.a,{options:[{value:"major",label:"Major"},{value:"minor",label:"Minor"},{value:"none",label:"None"}]})}),Object(T.jsx)(v.a.Item,{label:"Promotion vote",name:"gawnfallHigh",children:Object(T.jsx)(b.a,{options:[{value:"herin_overwhelming",label:"Overwhelming victory for Herin"},{value:"herin_promoted",label:"Herin promoted"},{value:"kaskia_promoted",label:"Kaskia promoted"},{value:"kaskia_overwhelming",label:"Overwhelming victory for Kaskia"}]})}),Object(T.jsx)(v.a.Item,{label:"Mercantile issue resolution",name:"gawnfallMercantile",children:Object(T.jsx)(b.a,{options:[{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}]})}),Object(T.jsx)(v.a.Item,{label:"Ardford's ban",name:"gawnfallArdford",children:Object(T.jsx)(b.a,{options:[{value:"overkill",label:"Lifted, with an extra bit of acceptance"},{value:"resolved",label:"Lifted"},{value:"unresolved",label:"Unsolved"}]})}),Object(T.jsx)(v.a.Item,{label:"Mother's Guard",name:"gawnfallMother",children:Object(T.jsx)(b.a,{options:[{value:"full_unlock",label:"Crushed"},{value:"partial_unlock",label:"Dealt with"},{value:"locked",label:"Unrestrained"}]})})]})]})}),Object(T.jsxs)(p.a,{title:"Post Gawnfall",type:"inner",children:[Object(T.jsxs)("div",{className:"reserves",children:[Object(T.jsx)(v.a.Item,{label:"Keep enough cash in reserve, if need be, to:",name:"reserves",children:Object(T.jsx)(b.a,{options:[{label:"Open the ruins after the war",value:0},{label:"Open the ruins before the war (".concat(L(5e6)," ProN)"),value:5e6},{label:"Open the ruins and buy everything but the Smithing in Kyangan (".concat(L(5125e3)," ProN)"),value:5125e3},{label:"Open the ruins and buy everything in Kyangan (".concat(L(5375e3)," ProN)"),value:5375e3}]})}),Object(T.jsx)(v.a.Item,{label:"Also make sure to have the additional amount available",name:"extra_reserves",tooltip:Object(T.jsxs)(T.Fragment,{children:["For extra expanses not covered in the previous option.",Object(T.jsx)("br",{}),"For example, if you also plan to buy Armory Upgrade and Entity's Shield Upgrade before the war, enter their total cost i.e. 260000."]}),children:Object(T.jsx)(f.a,{})})]}),Object(T.jsx)(g.a,{}),Object(T.jsx)(M,{form:l,purchased:[].concat(Object(m.a)(t),Object(m.a)(h),Object(m.a)(P)),list:"gawnfall"}),Object(T.jsx)(G,{form:l,purchased:[].concat(Object(m.a)(t),Object(m.a)(h),Object(m.a)(S),Object(m.a)(P)),list:"gawnfall"}),Object(T.jsx)(N,{})]}),Object(T.jsx)(v.a.Item,{children:Object(T.jsx)(O.a,{type:"primary",htmlType:"submit",loading:r,children:"Submit"})})]})},mt=function(e,t){return e.filter((function(e){return!!e[t]})).map((function(e){return{label:e.name,values:[e[t]]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},ht=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,i=e.decisions,r=a.investments;return Object(T.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(T.jsx)(q,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(T.jsxs)("div",{children:[Object(T.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(T.jsx)(H,{startingValue:t.givini,dataSources:[{title:"Investments",dataSource:mt(r,"givini")},{title:"Other changes",dataSource:ee(i,t.investments)}]})}),Object(T.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(T.jsx)(H,{startingValue:t.takkan,dataSources:[{title:"Investments",dataSource:mt(r,"takkan")},{title:"Other changes",dataSource:ue(i,t.investments)}]})}),Object(T.jsx)(p.a,{title:"Chalice States",type:"inner",children:Object(T.jsx)(H,{startingValue:t.chalice,dataSources:[{title:"Investments",dataSource:mt(r,"chalice")},{title:"Other changes",dataSource:Oe(i,t.investments)}]})})]})]})},vt=h.a.Title,pt=function(e){var t=e.gawnfallMother,n=e.gawnfallHigh,a=0;return"full_unlock"===t&&(a+=2),"partial_unlock"===t&&(a+=1),"herin_overwhelming"===n&&(a+=1),"kaskia_overwhelming"===n&&(a-=1),a},ft=function(e){return["resolved","overkill"].includes(e.gawnfallArdford)},bt=function(e){var t=e.decisions,n=e.initialStandings;return ft(t)&&n.investments.includes("Ardford Restaurant")&&n.investments.includes("Givini Teahouse Chain")},jt=function(e){var t=e.decisions;return e.initialStandings.investments.includes("Tradesmasher's Guild")&&"major"===t.gawnfallTakkan},gt=function(e){var t=e.decisions,n=e.initialStandings,a=e.investmentChanges,i=0;if(bt({decisions:t,initialStandings:n})&&(i+=15e3),jt({decisions:t,initialStandings:n})){var r=I.find((function(e){return"Tradesmasher's Guild"===e.name})).profits;i+=r({investments:a.investments,previousInvestments:n.investments,gawnfallTakkan:"major"})-r({investments:a.investments,previousInvestments:n.investments})}return i},Ot=function(e){var t=e.decisions,n=e.initialStandings,a=0;return bt({decisions:t,initialStandings:n})&&(a+=15e3),jt({decisions:t,initialStandings:n})&&(a+=25e3),a},xt=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,i,r,s,o,c,u,h,v,p,f,b,j,g,O,x,y,S,k,w,I,T,C,G,M,N,R,P,A,F,B,E,K;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.runInWoker,a=t.setResult,i=t.setError,r=t.secondRoundResult,s=t.values,o=r.finalStandings,c=s.research,u=s.mandatory1,h=s.yelarel,v=s.gawnfallTakkan,p=s.gawnfallMercantile,f=s.gawnfallArdford,b=s.gawnfallMother,j=s.vera,g=s.merchantSolution3,O=s.mandatory,x=s.banned,y=s.gawnfallHigh,S=s.reserves,k=s.extra_reserves,w=s.spending,I={research:c,gawnfallTakkan:v,gawnfallMercantile:p,gawnfallArdford:f,gawnfallMother:b,merchantSolution3:g,gawnfallHigh:y,lustlordStatuesBought:"min"===h},T=u.includes("Denmiel Archives"),C=u.includes("Tarran'Kan Housing + Tarran'Kan Trade Upgrade"),G=[].concat(Object(m.a)(u.filter((function(e){return!["Denmiel Archives","Tarran'Kan Housing + Tarran'Kan Trade Upgrade"].includes(e)}))),Object(m.a)(O)),"max"===h&&G.push("Lustlord Temples"),M=Object(d.a)(Object(d.a)({},r.misc),{},{gawnfallTakkan:v,gawnfallMother:b,gawnfallArdford:f,lustlordStatuesBought:I.lustlordStatuesBought}),N=function(){switch(I.gawnfallMercantile){case"excellent":return 25e4;case"good":return 1e5;case"poor":return-1e5;default:return 0}}(),R=["min"===h&&{name:"New Lustlord Statues",money:-5e4},j&&{name:"Goddess of Magic Statue",money:-1e4},{name:"Gawnfall social influence",social:pt(I)},{name:"One-time mercantile issue modifier",money:N},!!w&&{name:"Other spending",money:-w}].filter(Boolean),P={money:R.reduce((function(e,t){return e+(t.money||0)}),0),profits:0,social:R.reduce((function(e,t){return e+(t.social||0)}),0),givini:te(I,o.investments),takkan:de(I,o.investments),chalice:xe(I,o.investments),list:R},A=S+k-o.profits,A-=N,A-=Ot({decisions:I,initialStandings:o}),T&&(A-=2e4),C&&(A-=1e5),F=Object(d.a)(Object(d.a)({},M),{},{previousInvestments:o.investments,money:o.money+o.profits+(P.money-N)-(T?25e4:0)-(C?11e5:0),giviniStart:o.givini,giviniExtra:P.givini,otherRequirements:{mandatory:G,banned:[].concat(Object(m.a)(x),[T&&"Denmiel Archives",C&&"Tarran'Kan Housing + Tarran'Kan Trade Upgrade"]).filter(Boolean),social:"neutral"===I.merchantSolution3?Math.max(40-o.social,0):0,reserve:A},list:"gawnfall"}),e.next=20,n(F);case 20:if(B=e.sent){e.next=25;break}return a(void 0),i("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 25:(E=Object(d.a)(Object(d.a)({},B),{},{money:-B.price})).profits+=gt({decisions:I,initialStandings:o,investmentChanges:E}),T&&(E.price+=25e4,E.money-=25e4,E.profits+=2e4,E.social+=1,E.investments.push({name:"Denmiel Archives",price:25e4,profits:2e4,social:1})),C&&(E.price+=11e5,E.money-=11e5,E.profits+=1e5,E.social+=1,E.investments.push({name:"Tarran'Kan Housing + Tarran'Kan Trade Upgrade",price:11e5,profits:1e5,social:1,takkan:7})),K=[].concat(Object(m.a)(o.investments),Object(m.a)(E.investments.map((function(e){return e.name})))),(bt({decisions:I,initialStandings:o})||ft(I)&&K.includes("Ardford Restaurant")&&K.includes("Givini Teahouse Chain"))&&P.list.push({name:"Orri's Quest",social:1}),a({initialStandings:o,decisions:I,nonInvestmentChanges:P,investmentChanges:E,finalStandings:D({initialStandings:o,nonInvestmentChanges:P,investmentChanges:E}),misc:M}),i(void 0);case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yt=function(e){var t=e.firstRoundResult,n=e.secondRoundResult,a=e.runInWoker,i=e.loading,r=e.setResult,s=e.setError,o=e.result,c=n.finalStandings.investments,l=[t.decisions.research,n.decisions.research],u="wait"!==t.decisions.merchantSolution?t.decisions.merchantSolution:"wait"!==n.decisions.merchantSolution2?n.decisions.merchantSolution2:void 0;return Object(T.jsxs)("div",{className:"round-three",children:[Object(T.jsx)(vt,{level:2,children:"Chapter 4 \u2013 Round 3"}),Object(T.jsx)(dt,{previousInvestments:c,previousResearch:l,onFinish:function(e){xt({runInWoker:a,setResult:r,setError:s,secondRoundResult:n,values:e})},loading:i,merchantSolution:u}),Object(T.jsx)(ke,{data:o,children:Object(T.jsx)(ht,Object(d.a)({},o))})]})},St={},kt=function(e){return JSON.stringify(e)},wt=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)(!1),s=Object(o.a)(r,2),c=s[0],d=s[1],m=Object(a.useState)(),h=Object(o.a)(m,2),v=h[0],p=h[1],f=Object(a.useState)(0),b=Object(o.a)(f,2),j=b[0],g=b[1],O=Object(a.useState)(),x=Object(o.a)(O,2),y=x[0],S=x[1],k=Object(a.useState)(0),w=Object(o.a)(k,2),I=w[0],C=w[1],G=Object(a.useState)(),M=Object(o.a)(G,2),N=M[0],R=M[1],P=Object(a.useState)(),A=Object(o.a)(P,2),F=A[0],B=A[1],E=Object(a.useState)(),K=Object(o.a)(E,2),D=K[0],L=K[1],V=Object(a.useState)(),W=Object(o.a)(V,2),U=W[0],Y=W[1];if(Object(a.useEffect)((function(){return n||i(Ne()()),function(){null===n||void 0===n||n.terminate()}}),[n]),!n)return null;var q=function(e){var t=e.workerInstance,n=e.setLoading,a=e.setCombinationsCount,i=e.setProgress,r=e.setInvestmentsCount,s=e.setPreprogress;return function(){var e=Object(u.a)(l.a.mark((function e(o){var c,u,d,m,h,v,p,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=kt(o),!St[c]){e.next=3;break}return e.abrupt("return",St[c]);case 3:return n(!0),e.next=6,t.prepare(o);case 6:u=e.sent,r(u),s(0),d=0,m=0;case 11:if(!(m<=u)){e.next=20;break}return e.t0=d,e.next=15,t.preprocess();case 15:d=e.t0+=e.sent,s(m/u);case 17:m++,e.next=11;break;case 20:a(d),i(0),h=1e4,p=0;case 24:if(!(p<Math.ceil(d/h))){e.next=33;break}return f=Math.min((p+1)*h,d),e.next=28,t.process(p*h,f);case 28:v=e.sent,i(f/d);case 30:p++,e.next=24;break;case 33:return e.next=35,t.clean();case 35:return n(!1),a(void 0),r(void 0),i(0),s(0),St[c]=v,e.abrupt("return",v);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({workerInstance:n,setLoading:d,setCombinationsCount:p,setProgress:g,setInvestmentsCount:S,setPreprogress:C}),H=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.terminate(),t=Ne()(),e.next=4,t.clean();case 4:i(t),p(void 0),S(void 0),g(0),C(0),d(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)("div",{children:[Object(T.jsx)(Ae,{}),Object(T.jsx)(Ge,{runInWoker:q,loading:c,result:N,setResult:function(e){B(void 0),L(void 0),R(e)},setError:function(e){B(void 0),L(void 0),Y(e)}}),N&&Object(T.jsx)(ct,{runInWoker:q,loading:c,result:F,setResult:function(e){L(void 0),B(e)},setError:function(e){L(void 0),Y(e)},firstRoundResult:N}),N&&F&&Object(T.jsx)(yt,{firstRoundResult:N,secondRoundResult:F,runInWoker:q,loading:c,setResult:L,setError:Y,result:D}),c&&Object(T.jsx)(Ke,{combinationsCount:v,progress:j,preprogress:I,investmentsCount:y,abort:H}),U&&Object(T.jsx)(Le,{message:U})]})},It=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),r(e),s(e)}))};s.a.render(Object(T.jsx)(i.a.StrictMode,{children:Object(T.jsx)(wt,{})}),document.getElementById("root")),It()}},[[243,1,2]]]);
//# sourceMappingURL=main.7491ad5d.chunk.js.map