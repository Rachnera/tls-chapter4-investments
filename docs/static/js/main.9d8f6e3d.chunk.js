(this["webpackJsonptls-investment-advisor"]=this["webpackJsonptls-investment-advisor"]||[]).push([[0],{131:function(e,t,n){var r=n(241),i=["prepare","preprocess","process","clean"];e.exports=function(){var e=new Worker(n.p+"52a3c845f19fd26b1ebe.worker.js",{name:"[hash].worker.js"});return r(e,i),e}},163:function(e,t,n){},164:function(e,t,n){},242:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(26),s=n.n(a),c=(n(163),n(33)),o=n(42),l=n.n(o),u=n(69),d=(n(164),n(28)),m=n(39),h=n(248),p=n(250),v=n(247),j=n(251),b=n(98),f=n(99),g=n(119),O=n(47),x=[{name:"Bank of Stineford",price:4e5,profits:24e4},{name:"Stineford Weapons Store",price:2e5,profits:75e3},{name:"Trading Pillar Rights",price:3e5,profits:1e5},{name:"Stineford Succubus Tower",price:8e5,social:2},{name:"Yhilini Airship Fleet",price:1e6,profits:1e5},{name:"Min's Trade Route",price:4e5,profits:185e3,givini:1},{name:"Yhilini Succubi Trade",price:function(e){return e.chapter3Infrastructure?4e5:55e4},profits:2e5},{name:"Yhilini Brothel Reform",price:25e3,profits:35e3},{name:"Premium Steel Owner",price:function(e){return e.chapter1Steel?75e3:1e5},profits:1e4},{name:"Yhilini Bank Core Lender",price:function(e){return e.chapter1Bank?45e4:5e5},profits:15e4},{name:"Mercenary Offices",price:function(e){return e.chapter3Infrastructure?15e4:25e4},profits:15e3,social:2},{name:"Theltiar Rentals",price:425e3,profits:95e3,social:1},{name:"Theltiar Flowhouse",price:25e4,profits:8e4},{name:"Denmiel Mushrooms",price:105e3,profits:4e4},{name:"Denmiel Archives",price:25e4,profits:2e4,social:1},{name:"Eustrin Guild",price:6e5,profits:25e4},{name:"Succubus Armorer",price:1e5,profits:1e4},{name:"Gasm Falls Trade",price:275e3,profits:11e4},{name:"Givini Tunnels",price:15e5,profits:3e5,givini:3,takkan:3},{name:"Lustlord Temples",price:8e5,profits:5e4},{name:"Succubus Band Tour",price:1e5,profits:2e3,givini:2,social:1,takkan:2},{name:"Gasm Falls Water Cleanup",price:25e4,social:1},{name:"Orc Tunnels",price:2e5,social:1},{name:"Givini Smithing",price:2e5,profits:1e4,givini:2},{name:"Givini Orc Merchant",price:function(e){var t=e.giviniStart,n=void 0===t?0:t;return n<20?1e5:n<25?2e5:n<35?3e5:n<45?4e5:5e5},profits:function(e){var t=e.giviniStart,n=void 0===t?0:t,r=e.giviniExtra,i=n+(void 0===r?0:r)+e.investments.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.givini)||0)}),0);return i<20?25e3:i<30?5e4:i<40?1e5:i<50?15e4:2e5},givini:5},{name:"Givini Teahouse Chain",price:275e3,profits:3e4,givini:2,social:1,takkan:1},{name:"Bank of Givini",price:35e4,profits:3e5,givini:5,takkan:2},{name:"Givini Mage Guild",price:1e6,profits:4e4,givini:5},{name:"War Monument",price:1e6,givini:10,social:3,takkan:2},{name:"Tarran'Kan Housing + Tarran'Kan Trade Upgrade",price:11e5,profits:1e5,social:1,takkan:7},{name:"Hall of Mental Strength",price:2e5,profits:25e3,social:1,takkan:3},{name:"Booze Shack",price:15e4,profits:5e4,social:1,takkan:2},{name:"Tradesmasher's Guild",price:35e4,profits:function(e){var t=e.investments,n=e.previousInvestments,r=void 0===n?[]:n,i=1+[].concat(Object(m.a)(r),Object(m.a)(t.map((function(e){return e.name})))).filter((function(e){return["Cee'Kan Shipping","Lonely Sailor Services","Givini Orc Merchant","Orcish Democracy","Orc Pools Upgrade"].includes(e)})).length;return i<2?5e4:2===i?75e3:3===i?125e3:4===i?15e4:5===i?175e3:2e5},takkan:5},{name:"Lonely Sailor Services",price:25e4,profits:1e5,social:1,takkan:5},{name:"Cee'Kan Shipping",price:7e5,profits:2e5,takkan:5},{name:"Orcish Democracy",price:1e6,social:5,takkan:10},{name:"Imp Offices",price:1e5,social:1,takkan:1},{name:"Orc Pools Upgrade",price:5e5,social:2,takkan:5},{name:"Givini Banners + Givini Dragon Statue",price:3500,givini:1},{name:"Orcish Drake Statue + Orcish Gargoyle Statue + Orcish Golden Drake Statue",price:8e3,takkan:1}],y=n(4),S=h.a.Title,k=["Min's Trade Route","Yhilini Succubi Trade","Yhilini Bank Core Lender","Mercenary Offices","Theltiar Rentals","Theltiar Flowhouse","Denmiel Mushrooms","Denmiel Archives","Eustrin Guild","Gasm Falls Trade","Premium Steel Owner"],I={previous:["Premium Steel Owner","Min's Trade Route","Yhilini Succubi Trade","Eustrin Guild"],remainingPron:5e3,baseProfit:2e6,chapter1Bank:!0,chapter1Steel:!1,strategy:"social",startingSocial:34,chapter3Infrastructure:!0,merchantSolution:"wait",jhenno:"religion",magicalItems:"givini",mandatory:[],research:"purity"},w=function(e){return Object(m.a)(e).sort().map((function(e){return{label:e,value:e}}))},C={required:!0,message:"Please provide a value."},T=function(e){var t=e.onFinish,n=e.loading,i=Object(r.useState)(I.previous),a=Object(c.a)(i,2),s=a[0],o=a[1],l=p.a.useForm(),u=Object(c.a)(l,1)[0],d=Object(r.useState)(I.merchantSolution),m=Object(c.a)(d,2),h=m[0],T=m[1];return Object(r.useEffect)((function(){"neutral"===h&&"money"===u.getFieldValue("strategy")&&u.setFieldsValue({strategy:"social"})}),[u,h]),Object(r.useEffect)((function(){u.setFieldsValue({mandatory:u.getFieldValue("mandatory").filter((function(e){return!s.includes(e)}))})}),[u,s]),Object(y.jsxs)(p.a,{initialValues:I,onFinish:t,onValuesChange:function(e,t){o(t.previous),T(t.merchantSolution)},className:"round-form first-round-form",form:u,children:[Object(y.jsxs)("div",{className:"past-block",children:[Object(y.jsx)(S,{level:2,children:"Chapters 1-3"}),Object(y.jsxs)(v.a,{children:[Object(y.jsxs)("div",{className:"numbers",children:[Object(y.jsx)(p.a.Item,{label:"ProN remaining at the end of chapter 3",name:"remainingPron",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "ProN available".',rules:[C],children:Object(y.jsx)(j.a,{})}),Object(y.jsx)(p.a.Item,{label:"Total profit at the start of chapter 4",name:"baseProfit",tooltip:'In the Calculator, go to "First Tower Run and Investment and copy the value next to "Total ProN Return".',rules:[C],children:Object(y.jsx)(j.a,{})}),Object(y.jsx)(p.a.Item,{label:"Your social standing at the start of chapter 4",name:"startingSocial",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "Social Score".',rules:[C],children:Object(y.jsx)(j.a,{})})]}),Object(y.jsx)(p.a.Item,{label:"Investments already bought during chapters 2/3",name:"previous",children:Object(y.jsx)(b.a,{options:w(k),mode:"multiple"})}),Object(y.jsxs)("div",{className:"checkboxes",children:[!s.includes("Yhilini Bank Core Lender")&&Object(y.jsx)(p.a.Item,{name:"chapter1Bank",valuePropName:"checked",children:Object(y.jsx)(f.a,{children:"You invested 25,000 ProN in the Yhilin Bank during chapter 1."})}),!s.includes("Premium Steel Owner")&&Object(y.jsx)(p.a.Item,{name:"chapter1Steel",valuePropName:"checked",children:Object(y.jsx)(f.a,{children:"You invested 20,000 ProN in Premium Steel during chapter 1."})}),!(s.includes("Yhilini Succubi Trade")&&s.includes("Mercenary Offices"))&&Object(y.jsx)(p.a.Item,{name:"chapter3Infrastructure",valuePropName:"checked",children:Object(y.jsx)(f.a,{children:"You funded Yhilin Infrastructure during chapter 3."})})]})]})]}),Object(y.jsx)(S,{level:2,children:"Chapter 4 \u2013 Round 1"}),Object(y.jsxs)(v.a,{title:"Strategy",children:[Object(y.jsx)(p.a.Item,{name:"strategy",label:"Succession crisis",children:Object(y.jsx)(g.a.Group,{options:[{label:"Focus on profits; do only the bare minimum for the Ardan succession crisis (New Givini \u2265 25).",value:"money",disabled:"neutral"===h},{label:"Mix profits and social; reach most thresholds for the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40).",value:"social"},{label:"Go all in on the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40, dedicated investments).",value:"succession"}]})}),Object(y.jsxs)("div",{className:"selects",children:[Object(y.jsx)(p.a.Item,{label:"Research",name:"research",children:Object(y.jsx)(b.a,{options:[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}]})}),Object(y.jsx)(p.a.Item,{label:"Jhenno's cooperation",name:"jhenno",children:Object(y.jsx)(b.a,{options:[{value:"politics",label:"Politics"},{value:"religion",label:"Religion"}]})}),Object(y.jsx)(p.a.Item,{label:"Rose's house magical items",name:"magicalItems",children:Object(y.jsx)(b.a,{options:[{value:"givini",label:"Givini"},{value:"takkan",label:"Tak'Kan"}]})}),Object(y.jsx)(p.a.Item,{label:"Merchant dispute",name:"merchantSolution",children:Object(y.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})})]}),Object(y.jsx)(p.a.Item,{label:"Investments you explicitly want to buy, for any reason",name:"mandatory",children:Object(y.jsx)(b.a,{options:w(x.map((function(e){return e.name})).filter((function(e){return!s.includes(e)}))),mode:"multiple"})}),Object(y.jsx)(p.a.Item,{children:Object(y.jsx)(O.a,{type:"primary",htmlType:"submit",loading:n,children:"Submit"})})]})]})},P=n(132),R=n(246),G=function(e){var t=e.initialStandings,n=e.investmentChanges,r=e.nonInvestmentChanges,i={};return["profits","givini","social","takkan"].forEach((function(e){i[e]=t[e]+(n[e]||0)+(r[e]||0)})),i.investments=[].concat(Object(m.a)(t.investments),Object(m.a)(n.investments.map((function(e){return e.name})))),i.money=t.money+t.profits-n.price+r.money,i},N=function(e){return e.toLocaleString("en-US")},M=120,F=function(e){var t=e.children,n=e.format?N(Math.abs(t)):Math.abs(t);return"".concat(t<0?"-":"+").concat(n)},E=function(e){var t=e.investments.map((function(e){var t=e.name,n=Object(P.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),n=[{title:"Name",dataIndex:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Price",dataIndex:"price",render:function(e){return N(e)},sorter:function(e,t){return e.price-t.price},width:M},{title:"Profits",dataIndex:"profits",render:function(e){return N(e)},sorter:function(e,t){return e.profits-t.profits},width:M},{title:"Social",dataIndex:"social",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(y.jsx)(F,{children:e})},width:M}];return Object(y.jsx)(R.a,{dataSource:t,columns:n,pagination:!1})},B=function(e){var t=e.list,n=(void 0===t?[]:t).map((function(e){var t=e.name,n=Object(P.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(y.jsx)(F,{format:!0,children:e})},i=[{title:"Name",dataIndex:"name"},{title:"Price",dataIndex:"price",render:r,width:M},{title:"Profits",dataIndex:"profits",render:r,width:M},{title:"Social",dataIndex:"social",render:r,width:M}];return Object(y.jsx)(R.a,{dataSource:n,columns:i,pagination:!1})},D=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,r=e.investmentChanges,i=function(e,t){var n=t.key;return["base","total"].includes(n)?N(e):Object(y.jsx)(F,{format:!0,children:e})},a=[{dataIndex:"category"},{title:"ProN",dataIndex:"money",render:i,width:M},{title:"Profits",dataIndex:"profits",render:i,width:M},{title:"Social",dataIndex:"social",render:i,width:M}],s=function(e){return t[e]+n[e]+r[e]},c=r.profits-r.investments.reduce((function(e,t){return e+t.profits}),0),o=[Object(d.a)(Object(d.a)({},t),{},{key:"base",category:"Previously"}),{key:"previous_investments",category:"Start of the round",money:t.profits,profits:0,social:0},Object(d.a)(Object(d.a)({},r),{},{key:"investments",category:"Changes from new investments",money:-r.price,profits:r.profits-c}),Object(d.a)(Object(d.a)({},n),{},{key:"other",category:"Other changes",profits:n.profits+c})],l=c>0?[].concat(Object(m.a)(n.list),[{name:"Extra profits from past investments",profits:c}]):n.list;return Object(y.jsx)(R.a,{dataSource:o,columns:a,pagination:!1,bordered:!0,expandable:{expandedRowRender:function(e){var t=e.key;return"investments"===t?Object(y.jsx)(E,{investments:r.investments}):"other"===t?Object(y.jsx)(B,{list:l}):null},rowExpandable:function(e){var t,r=e.key;return"investments"===r||!("other"!==r||!(null===(t=n.list)||void 0===t?void 0:t.length))},defaultExpandAllRows:!0},summary:function(){return Object(y.jsxs)(R.a.Summary.Row,{children:[Object(y.jsx)(R.a.Summary.Cell,{colSpan:2,children:"Standings at the end of the round"}),Object(y.jsx)(R.a.Summary.Cell,{children:N(t.money+t.profits+n.money-r.price)}),Object(y.jsx)(R.a.Summary.Cell,{children:N(s("profits"))}),Object(y.jsx)(R.a.Summary.Cell,{children:s("social")})]})},className:"ledger"})},A=function(e){var t=e.startingValue,n=void 0===t?0:t,r=e.dataSources;return Object(y.jsxs)("table",{className:"addition",children:[Object(y.jsx)("tbody",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:"Initial value"}),Object(y.jsx)("td",{children:n}),Object(y.jsx)("td",{})]})}),r.filter((function(e){return e.dataSource.length>0})).map((function(e,t){var n=e.title,r=e.dataSource;return Object(y.jsxs)("tbody",{children:[Object(y.jsx)("tr",{children:Object(y.jsx)("th",{colSpan:"3",scope:"col",children:n})}),r.map((function(e,t){var n=e.label,r=e.values,i=e.explanation;return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:n}),Object(y.jsx)("td",{children:r.map((function(e){return"+".concat(e)})).join(" ")}),Object(y.jsx)("td",{children:i})]},t.toString())}))]},t.toString())})),Object(y.jsx)("tfoot",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("th",{scope:"row",children:"Total"}),Object(y.jsx)("td",{children:n+r.reduce((function(e,t){return e+t.dataSource.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}))}),0)}),0)})]})})]})},V=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},W=function(e){return[{label:"Petitions",values:[5,5,2,2,2]},{label:"New Givini Trade",values:[5],explanation:"On purchase"},e.investments.includes("Min's Trade Route")&&{label:"Min's Trade Route",values:[1]}].filter(Boolean)},q=function(e){var t=e.chapter3Investments;return-5+V(W({investments:t}))},L=function(e){var t=e.merchantSolution;return["givini"===e.magicalItems&&{label:"House Rose's magical items: Givini",values:[2]},"neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"Givino Vinai equipment shop girl",values:[1]},{label:"Givini king",values:[1]},{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},Y=function(){return V(L.apply(void 0,arguments))},K=function(e){var t=e.merchantSolution2;return["neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},U=function(){return V(K.apply(void 0,arguments))},H=function(e){var t=e.chapter3Investments,n=void 0===t?[]:t,r=e.roundOneInvestments,i=void 0===r?[]:r,a=e.decisions,s=void 0===a?{}:a;return Object(y.jsx)(A,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:W({investments:n})},{title:"Investments",dataSource:i.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,r=t.label;return n.localeCompare(r)}))},{title:"Other changes",dataSource:L(s)}]})},J=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},z=function(e){return["takkan"===e.magicalItems&&{label:"House Rose's magical items: Tak'Kan",values:[2]},{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===e.research&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},_=function(){return J(z.apply(void 0,arguments))},Q=function(e){var t=e.roundOneInvestments,n=void 0===t?[]:t,r=e.decisions,i=void 0===r?{}:r;return Object(y.jsx)(A,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:[{label:"Petitions",values:[5,2,2,5]},{label:"Tak'Kan Trade",values:[5],explanation:"On purchase"}]},{title:"Investments",dataSource:n.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,r=t.label;return n.localeCompare(r)}))},{title:"Other changes",dataSource:z(i)}]})},X=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,r=e.investmentChanges,i=e.decisions;return Object(y.jsxs)(v.a,{title:"Changes",className:"results",children:[Object(y.jsx)(D,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:r}),Object(y.jsxs)("div",{children:[Object(y.jsx)(v.a,{title:"New Givini",type:"inner",children:Object(y.jsx)(H,{chapter3Investments:t.investments,roundOneInvestments:r.investments,decisions:i})}),Object(y.jsx)(v.a,{title:"Tak'Kan",type:"inner",children:Object(y.jsx)(Q,{roundOneInvestments:r.investments,decisions:i})})]})]})},Z=function(e,t){var n=t.strategy,r=t.jhenno,i=t.merchantSolution;return"money"===n?0:"politics"===r&&"neutral"!==i?39-e:40-e},$=function(e){var t=["politics"===e.jhenno&&{name:"Jhenno's political cooperation",social:1},{name:"Succession crisis' reward (best result)",social:3},{name:"The Three Trades become less profitable",profits:-3e5}].filter(Boolean);return{givini:Y(e),takkan:_(e),money:0,profits:t.reduce((function(e,t){var n=t.profits;return e+(void 0===n?0:n)}),0),social:t.reduce((function(e,t){var n=t.social;return e+(void 0===n?0:n)}),0),list:t}},ee=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,i,a,s,c,o,u,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.runInWoker,r=t.initialStandings,i=t.decisions,a=t.nonInvestmentChanges,s=t.mandatory,c=t.misc,o=r.givini,u=a.givini,m=Object(d.a)(Object(d.a)({},c),{},{previousInvestments:r.investments,money:r.money+r.profits,otherRequirements:{social:Z(r.social,i),givini:(l={giviniStart:o,giviniExtra:u},25-l.giviniStart-l.giviniExtra+3),mandatory:s,atLeastOne:"succession"===i.strategy?["War Monument","Givini Mage Guild"]:void 0},giviniStart:o,giviniExtra:u}),e.abrupt("return",n(m));case 5:case"end":return e.stop()}var l}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,i,a,s,c,o,u,m,h,p,v,j,b,f,g,O,x,y,S,k,I,w,C;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,r=t.setResult,i=t.runInWoker,(a=t.setError)(void 0),s=n.previous,c=void 0===s?[]:s,o=n.remainingPron,u=n.baseProfit,m=n.startingSocial,h=n.strategy,p=n.merchantSolution,v=n.jhenno,j=n.magicalItems,b=n.research,f=n.mandatory,g=n.chapter1Bank,O=n.chapter1Steel,x=n.chapter3Infrastructure,y={money:o,profits:u,investments:c,social:m,givini:q({chapter3Investments:c}),takkan:-5+J([{label:"Petitions",values:[5,2,2,5]},{label:"Tak'Kan Trade",values:[5],explanation:"On purchase"}])},k={chapter1Bank:g,chapter1Steel:O,chapter3Infrastructure:x},I=$(S={strategy:h,merchantSolution:p,magicalItems:j,research:b,jhenno:v}),e.next=9,ee({runInWoker:i,initialStandings:y,decisions:S,nonInvestmentChanges:I,mandatory:f,misc:k});case 9:if(w=e.sent){e.next=14;break}return r(void 0),a("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 14:C=Object(d.a)(Object(d.a)({},w),{},{money:-w.price}),r({initialStandings:y,decisions:S,nonInvestmentChanges:I,investmentChanges:C,finalStandings:G({initialStandings:y,nonInvestmentChanges:I,investmentChanges:C}),misc:k}),a(void 0);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(e){var t=e.runInWoker,n=e.loading,i=e.result,a=e.setResult,s=e.setError,c=Object(r.useRef)(null);return Object(r.useEffect)((function(){i&&c.current&&c.current.scrollIntoView({behavior:"smooth"})}),[i,c]),Object(y.jsxs)("div",{className:"round-one",children:[Object(y.jsx)(T,{onFinish:function(e){te({values:e,setResult:a,runInWoker:t,setError:s})},loading:n}),i&&Object(y.jsx)("div",{ref:c,children:Object(y.jsx)(X,Object(d.a)({},i))})]})},re=n(131),ie=n.n(re),ae=n(255),se=h.a.Title,ce=function(){return Object(y.jsxs)("div",{className:"disclaimer",children:[Object(y.jsxs)("div",{className:"preamble",children:[Object(y.jsx)(se,{children:"Investment advisor"}),Object(y.jsxs)("p",{children:["A tool to help you choose the best theoretical best possible investments for (the early steps of chapter 4 of) ",Object(y.jsx)("a",{href:"https://the-last-sovereign.blogspot.com/",children:"The Last Sovereign"}),"."]}),Object(y.jsx)("p",{children:"Just fill in the requested information, choose your strategy and let a quasi-brute force algorithm determine what's best for you (assuming a definition of best here as highest short term returns, then lowest price, while still fulfilling the requirements of your strategy)."}),Object(y.jsxs)("p",{children:["This is definetely an advanced tool, intended for people who are already familiar with the game's ",Object(y.jsx)("a",{href:"https://thelastsovereign.miraheze.org/wiki/Secret_stats",children:"inner workings"}),", with the awesome ",Object(y.jsx)("a",{href:"https://thelastsovereign.flarum.cloud/d/15-calculator",children:"Calculator"}),", and are now looking for the last lousy optimizations they might have missed."]})]}),Object(y.jsx)(ae.a,{message:"Assumptions",description:Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("span",{children:"This tool takes for granted that:"}),Object(y.jsxs)("ol",{children:[Object(y.jsx)("li",{children:"The Succubus Tower was visited during chapter 1."}),Object(y.jsx)("li",{children:"AriGarda was bribed during chapter 2."}),Object(y.jsx)("li",{children:"Tradesmasher and the Succubus Armorer were met during chapter 3."}),Object(y.jsx)("li",{children:"The three unique Trades (New Givini, Tak'Kan and Chalice States) were bought at the end of chapter 3."}),Object(y.jsx)("li",{children:"Chapter 3 in general was good enough for Yhilin to reach its final state during the first investment phase of Chapter 4."}),Object(y.jsx)("li",{children:"Chapter 3 in general and the war in particular were good enough for all petitions favorable to Givini to appear."}),Object(y.jsx)("li",{children:"All such petitions were approved."}),Object(y.jsx)("li",{children:"If purchased, the Givini Orc Merchant is bought before any other investment of the round."})]})]}),type:"info",showIcon:!0})]})},oe=n(253),le=n(252),ue=n(245),de=n(249),me=function(e){var t=e.combinationsCount,n=e.progress,r=e.investmentsCount,i=e.preprogress,a=e.abort;return r?Object(y.jsxs)(oe.a,{visible:!0,centered:!0,closable:!1,footer:null,children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("p",{children:["Prefiltering ".concat(Math.pow(2,r).toLocaleString("en-US")," (2"),Object(y.jsx)("sup",{children:r}),") possibilities\u2026"]}),Object(y.jsx)(le.a,{percent:Math.round(100*i)})]}),!!t&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(ue.a,{}),Object(y.jsxs)("div",{children:[Object(y.jsx)("p",{children:"Processing ".concat(t.toLocaleString("en-US")," remaining possibilities\u2026")}),Object(y.jsx)(le.a,{percent:Math.round(1e4*n)/100})]})]}),Object(y.jsx)(O.a,{danger:!0,icon:Object(y.jsx)(de.a,{}),onClick:a,className:"abort-button",children:"Abort"})]}):null},he=n(254),pe=function(e){var t=e.message;return Object(y.jsx)(v.a,{children:Object(y.jsx)(he.a,{status:"warning",title:t})})},ve=[{key:"Tower Little Girl talk",magic:1,military:0,price:0},{key:"Deluxe Givini Dragon Statue",magic:1,military:0,price:5e3},{key:"HQ Shrine",magic:1,military:0,price:5e3},{key:"Orc Lab Upgrade",magic:2,military:5,price:25e3},{key:"Magical Shielding Upgrade",magic:5,military:0,price:1e5}],je=[{key:"Research: Base Defense",military:5,magic:10,price:0}],be=[{key:"Wynn's Shield Upgrade",magic:5,military:0,price:1e5},{key:"Extradimensional Foundation",magic:5,military:5,price:225e3}],fe=[{key:"Armory Upgrade",military:5,magic:0,price:1e4},{key:"Orc Guard Posts",military:3,magic:0,price:5e3},{key:"Supplies Upgrade",military:2,magic:0,price:1e4}],ge=function(e){return"+".concat(e)},Oe=[{title:"Upgrade",dataIndex:"key"},{title:"Price",dataIndex:"price",render:function(e){return N(e)},sorter:function(e,t){return e.price-t.price}},{title:"Magic",dataIndex:"magic",render:ge,sorter:function(e,t){return e.magic-t.magic}},{title:"Military",dataIndex:"military",render:ge,sorter:function(e,t){return e.military-t.military}}],xe=function(e){var t=e.research,n=e.extra;return[ve,"defense"===t?je:be,n&&fe].filter(Boolean).flat(1)},ye=function(e,t){return e.reduce((function(e,n){return e+n[t]}),0)},Se=function(e){return ye(xe(e),"price")},ke=function(e){var t=e.research,n=e.extra,r=xe({research:t,extra:n});return Object(y.jsx)("div",{className:"headquarters-upgrades",children:Object(y.jsx)(R.a,{dataSource:r,columns:Oe,pagination:!1,summary:function(){return Object(y.jsxs)(R.a.Summary.Row,{children:[Object(y.jsx)(R.a.Summary.Cell,{children:"Total"}),Object(y.jsx)(R.a.Summary.Cell,{children:N(ye(r,"price"))}),Object(y.jsx)(R.a.Summary.Cell,{children:ye(r,"magic")}),Object(y.jsx)(R.a.Summary.Cell,{children:ye(r,"military")})]})}})})},Ie={merchantSolution2:"neutral",headquarters:"enough",orcCouncil:.8,mandatory:[]},we=function(e){var t=e.onFinish,n=e.loading,i=e.firstRoundDecisions,a=e.purchasedInvestments,s=Object(r.useState)("extra"===Ie.headquarters),o=Object(c.a)(s,2),l=o[0],u=o[1],d=p.a.useForm(),m=Object(c.a)(d,1)[0],h=i.research;return Object(y.jsx)(p.a,{initialValues:Ie,onFinish:t,className:"round-form second-round-form",form:m,onValuesChange:function(e,t){u("extra"===t.headquarters)},children:Object(y.jsxs)(v.a,{title:"Stategy",type:"inner",children:[Object(y.jsxs)("div",{className:"two-columns",children:[Object(y.jsxs)("div",{children:["wait"===i.merchantSolution&&Object(y.jsx)(p.a.Item,{label:"Merchant dispute",name:"merchantSolution2",children:Object(y.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})}),Object(y.jsx)(p.a.Item,{name:"orcCouncil",label:"Orc council",children:Object(y.jsx)(b.a,{options:[{label:"Substantial majority (\u2265 65%)",value:.65},{label:"Overwhelming majority (\u2265 80%)",value:.8}]})}),Object(y.jsx)(p.a.Item,{name:"headquarters",label:"Headquarters",children:Object(y.jsx)(b.a,{options:[{label:"Pay ".concat(N(Se({research:h}))," for strong magical defenses."),value:"enough"},{label:"Pay ".concat(N(Se({research:h,extra:!0}))," for strong magical and military defenses."),value:"extra"}]})}),Object(y.jsx)(p.a.Item,{label:"Investments you explicitly want to buy now (example: Airships)",name:"mandatory",children:Object(y.jsx)(b.a,{options:x.filter((function(e){var t=e.name;return!a.includes(t)})).map((function(e){var t=e.name;return{label:t,value:t}})),mode:"multiple"})})]}),Object(y.jsx)(ke,{research:h,extra:l})]}),Object(y.jsx)(p.a.Item,{children:Object(y.jsx)(O.a,{type:"primary",htmlType:"submit",loading:n,children:"Submit"})})]})})},Ce=function(e){var t=e.startingValue,n=e.roundTwoInvestments,r=void 0===n?[]:n,i=e.decisions,a=void 0===i?{}:i;return Object(y.jsx)(A,{startingValue:t,dataSources:[{title:"Investments",dataSource:r.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,r=t.label;return n.localeCompare(r)}))},{title:"Other changes",dataSource:K(a)}]})},Te=h.a.Text,Pe=function(e){var t=e.startingValue,n=e.roundTwoInvestments,r=void 0===n?[]:n,i=(e.decisions,e.roundOneResearch),a=e.previousInvestments,s=void 0===a?[]:a,c=e.takkanScore,o=function(e){var t=e.investments,n=void 0===t?[]:t,r=e.takkan,i=e.researches,a=5,s=2;return r>=40?a+=4:r>=30?(a+=3,s+=1):r>=20?(a+=2,s+=2):r>=10?(a+=1,s+=3):s+=4,(void 0===i?[]:i).includes("orc")?a+=1:s+=1,a+=n.filter((function(e){return["Orc Pools Upgrade","Tarran'Kan Housing + Tarran'Kan Trade Upgrade","Hall of Mental Strength","Imp Offices"].includes(e)})).length,n.includes("Orcish Democracy")&&(a=2),a/(a+s)}({researches:[i],investments:[].concat(Object(m.a)(s),Object(m.a)(r.map((function(e){return e.name})))),takkan:c});return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(A,{startingValue:t,dataSources:[{title:"Investments",dataSource:r.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,r=t.label;return n.localeCompare(r)}))},{title:"Other changes",dataSource:[{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"}]}]}),Object(y.jsxs)(Te,{children:["Orc council: ",Object(y.jsxs)(Te,{type:o>=.8?"success":"warning",children:[(100*o).toFixed(2),"%"]})]})]})},Re=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,r=e.investmentChanges,i=e.decisions,a=e.roundOneDecisions;return Object(y.jsxs)(v.a,{title:"Changes",className:"results",children:[Object(y.jsx)(D,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:r}),Object(y.jsxs)("div",{children:[Object(y.jsx)(v.a,{title:"New Givini",type:"inner",children:Object(y.jsx)(Ce,{startingValue:t.givini,roundTwoInvestments:r.investments,decisions:i})}),Object(y.jsx)(v.a,{title:"Tak'Kan",type:"inner",children:Object(y.jsx)(Pe,{startingValue:t.takkan,roundTwoInvestments:r.investments,decisions:i,takkanScore:t.takkan+r.takkan,roundOneResearch:a.research,previousInvestments:t.investments})})]})]})},Ge=h.a.Title,Ne=function(e,t){return"neutral"===t.merchantSolution2&&e<40?40-e:0},Me=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,i,a,s,c,o,u,m,h,p,v,j,b,f,g,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.setResult,r=t.runInWoker,i=t.setError,a=t.firstRoundResult,s=t.values,c=a.finalStandings,o=a.misc,u=s.merchantSolution2,m=s.headquarters,h=s.orcCouncil,p=s.mandatory,v={merchantSolution2:u,headquarters:m,orcCouncil:h},j=Se({research:a.decisions.research,extra:"extra"===v.headquarters}),b={money:-j,profits:0,social:0,givini:U(v),takkan:1,list:[{name:"Headquarters upgrades",price:-j}]},f=Object(d.a)(Object(d.a)({},o),{},{previousInvestments:c.investments,money:c.money+c.profits-j,giviniStart:c.givini,giviniExtra:b.givini,takkan:c.takkan,completedResearch:[a.decisions.research],otherRequirements:{social:Ne(c.social,v),orcCouncil:v.orcCouncil,mandatory:p}}),e.next=9,r(f);case 9:if(g=e.sent){e.next=14;break}return n(void 0),i("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 14:O=Object(d.a)(Object(d.a)({},g),{},{money:-g.price}),n({initialStandings:c,decisions:v,nonInvestmentChanges:b,investmentChanges:O,finalStandings:G({initialStandings:c,nonInvestmentChanges:b,investmentChanges:O}),misc:o}),i(void 0);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(e){var t=e.runInWoker,n=e.loading,i=e.result,a=e.setResult,s=e.setError,c=e.firstRoundResult,o=Object(r.useRef)(null);return Object(r.useEffect)((function(){i&&o.current&&o.current.scrollIntoView({behavior:"smooth"})}),[i,o]),Object(y.jsxs)("div",{className:"round-two",children:[Object(y.jsx)(Ge,{level:2,children:"Chapter 4 \u2013 Round 2"}),Object(y.jsx)(we,{onFinish:function(e){Me({setResult:a,runInWoker:t,setError:s,firstRoundResult:c,values:e})},loading:n,firstRoundDecisions:c.decisions,purchasedInvestments:c.finalStandings.investments}),i&&Object(y.jsx)("div",{ref:o,children:Object(y.jsx)(Re,Object(d.a)({roundOneDecisions:c.decisions},i))})]})},Ee={},Be=function(e){return JSON.stringify(e)},De=function(){var e=Object(r.useState)(),t=Object(c.a)(e,2),n=t[0],i=t[1],a=Object(r.useState)(!1),s=Object(c.a)(a,2),o=s[0],d=s[1],m=Object(r.useState)(),h=Object(c.a)(m,2),p=h[0],v=h[1],j=Object(r.useState)(0),b=Object(c.a)(j,2),f=b[0],g=b[1],O=Object(r.useState)(),x=Object(c.a)(O,2),S=x[0],k=x[1],I=Object(r.useState)(0),w=Object(c.a)(I,2),C=w[0],T=w[1],P=Object(r.useState)(),R=Object(c.a)(P,2),G=R[0],N=R[1],M=Object(r.useState)(),F=Object(c.a)(M,2),E=F[0],B=F[1],D=Object(r.useState)(),A=Object(c.a)(D,2),V=A[0],W=A[1];if(Object(r.useEffect)((function(){return n||i(ie()()),function(){null===n||void 0===n||n.terminate()}}),[n]),!n)return null;var q=function(e){var t=e.workerInstance,n=e.setLoading,r=e.setCombinationsCount,i=e.setProgress,a=e.setInvestmentsCount,s=e.setPreprogress;return function(){var e=Object(u.a)(l.a.mark((function e(c){var o,u,d,m,h,p,v,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Be(c),!Ee[o]){e.next=3;break}return e.abrupt("return",Ee[o]);case 3:return n(!0),e.next=6,t.prepare(c);case 6:u=e.sent,a(u),s(0),d=0,m=0;case 11:if(!(m<=u)){e.next=20;break}return e.t0=d,e.next=15,t.preprocess();case 15:d=e.t0+=e.sent,s(m/u);case 17:m++,e.next=11;break;case 20:r(d),i(0),h=1e4,v=0;case 24:if(!(v<Math.ceil(d/h))){e.next=33;break}return j=Math.min((v+1)*h,d),e.next=28,t.process(v*h,j);case 28:p=e.sent,i(j/d);case 30:v++,e.next=24;break;case 33:return e.next=35,t.clean();case 35:return n(!1),r(void 0),a(void 0),i(0),s(0),Ee[o]=p,e.abrupt("return",p);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({workerInstance:n,setLoading:d,setCombinationsCount:v,setProgress:g,setInvestmentsCount:k,setPreprogress:T}),L=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.terminate(),t=ie()(),e.next=4,t.clean();case 4:i(t),v(void 0),k(void 0),g(0),T(0),d(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{children:[Object(y.jsx)(ce,{}),Object(y.jsx)(ne,{runInWoker:q,loading:o,result:G,setResult:function(e){B(void 0),N(e)},setError:function(e){B(void 0),W(e)}}),G&&Object(y.jsx)(Fe,{runInWoker:q,loading:o,result:E,setResult:B,setError:W,firstRoundResult:G}),o&&Object(y.jsx)(me,{combinationsCount:p,progress:f,preprogress:C,investmentsCount:S,abort:L}),V&&Object(y.jsx)(pe,{message:V})]})},Ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,256)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),a(e),s(e)}))};s.a.render(Object(y.jsx)(i.a.StrictMode,{children:Object(y.jsx)(De,{})}),document.getElementById("root")),Ae()}},[[242,1,2]]]);
//# sourceMappingURL=main.9d8f6e3d.chunk.js.map