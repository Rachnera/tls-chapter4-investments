(this["webpackJsonptls-investment-advisor"]=this["webpackJsonptls-investment-advisor"]||[]).push([[0],{132:function(e,t,n){var a=n(242),r=["prepare","preprocess","process","clean"];e.exports=function(){var e=new Worker(n.p+"a1b3b64a41eeeb6a26a8.worker.js",{name:"[hash].worker.js"});return a(e,r),e}},164:function(e,t,n){},165:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(29),s=n.n(i),o=(n(164),n(26)),l=n(36),c=n.n(l),u=n(53),d=(n(165),n(25)),m=n(23),h=n(249),v=n(251),p=n(248),f=n(252),b=n(98),j=n(99),g=n(48),O=n(107),x=[{name:"Bank of Stineford",price:4e5,profits:24e4},{name:"Stineford Weapons Store",price:2e5,profits:75e3},{name:"Trading Pillar Rights",price:3e5,profits:1e5},{name:"Stineford Succubus Tower",price:8e5,social:2},{name:"Yhilini Airship Fleet",price:1e6,profits:1e5},{name:"Min's Trade Route",price:4e5,profits:185e3,givini:1},{name:"Yhilini Succubi Trade",price:function(e){return e.chapter3Infrastructure?4e5:55e4},profits:2e5},{name:"Yhilini Brothel Reform",price:25e3,profits:35e3},{name:"Premium Steel Owner",price:function(e){return e.chapter1Steel?75e3:1e5},profits:1e4},{name:"Yhilini Bank Core Lender",price:45e4,profits:15e4},{name:"Mercenary Offices",price:function(e){return e.chapter3Infrastructure?15e4:25e4},profits:15e3,social:2},{name:"Theltiar Rentals",price:425e3,profits:95e3,social:1},{name:"Theltiar Flowhouse",price:25e4,profits:8e4},{name:"Denmiel Mushrooms",price:105e3,profits:4e4},{name:"Denmiel Archives",price:25e4,profits:2e4,social:1},{name:"Eustrin Guild",price:6e5,profits:25e4},{name:"Succubus Armorer",price:1e5,profits:1e4},{name:"Gasm Falls Trade",price:275e3,profits:11e4},{name:"Givini Tunnels",price:15e5,profits:3e5,givini:3,takkan:3},{name:"Lustlord Temples",price:8e5,profits:5e4},{name:"Succubus Band Tour",price:1e5,profits:2e3,givini:2,social:1,takkan:2},{name:"Gasm Falls Water Cleanup",price:25e4,social:1},{name:"Orc Tunnels",price:2e5,social:1},{name:"Givini Smithing",price:2e5,profits:1e4,givini:2},{name:"Givini Orc Merchant",price:function(e){var t=e.giviniStart,n=void 0===t?0:t;return n<20?1e5:n<25?2e5:n<35?3e5:n<45?4e5:5e5},profits:function(e){var t=e.giviniStart,n=void 0===t?0:t,a=e.giviniExtra,r=n+(void 0===a?0:a)+e.investments.reduce((function(e,t){return e+((null===t||void 0===t?void 0:t.givini)||0)}),0);return r<20?25e3:r<30?5e4:r<40?1e5:r<50?15e4:2e5},givini:5},{name:"Givini Teahouse Chain",price:275e3,profits:3e4,givini:2,social:1,takkan:1},{name:"Bank of Givini",price:35e4,profits:3e5,givini:5,takkan:2},{name:"Givini Mage Guild",price:1e6,profits:4e4,givini:5},{name:"War Monument",price:1e6,givini:10,social:3,takkan:2},{name:"Tarran'Kan Housing + Tarran'Kan Trade Upgrade",price:11e5,profits:1e5,social:1,takkan:7},{name:"Hall of Mental Strength",price:2e5,profits:25e3,social:1,takkan:3},{name:"Booze Shack",price:15e4,profits:5e4,social:1,takkan:2},{name:"Tradesmasher's Guild",price:35e4,profits:function(e){var t=e.investments,n=e.previousInvestments,a=void 0===n?[]:n,r=1+[].concat(Object(m.a)(a),Object(m.a)(t.map((function(e){return e.name})))).filter((function(e){return["Cee'Kan Shipping","Lonely Sailor Services","Givini Orc Merchant","Orcish Democracy","Orc Pools Upgrade"].includes(e)})).length;return r<2?5e4:2===r?75e3:3===r?125e3:4===r?15e4:5===r?175e3:2e5},takkan:5},{name:"Lonely Sailor Services",price:25e4,profits:1e5,social:1,takkan:5},{name:"Cee'Kan Shipping",price:7e5,profits:2e5,takkan:5},{name:"Orcish Democracy",price:1e6,social:5,takkan:10},{name:"Imp Offices",price:1e5,social:1,takkan:1},{name:"Orc Pools Upgrade",price:5e5,social:2,takkan:5},{name:"Givini Banners + Givini Dragon Statue",price:3500,givini:1},{name:"Orcish Drake Statue + Orcish Gargoyle Statue + Orcish Golden Drake Statue",price:8e3,takkan:1}],y=function(e){var t=e.gawnfallArdford;return"resolved"===t||"overkill"===t},k=function(e){return function(t){return y(t)&&e||1/0}},S=[].concat(Object(m.a)(x.filter((function(e){var t=e.name;return!["Lustlord Temples","Tarran'Kan Housing + Tarran'Kan Trade Upgrade","Denmiel Archives"].includes(t)}))),[{name:"Lustlord Temples",price:75e4,profits:5e4},{name:"Tarran'Kan Housing + Tarran'Kan Trade Upgrade",price:function(e){var t=e.gawnfallTakkan;return"major"===t?85e4:"minor"===t?1e6:11e5},profits:1e5,social:1,takkan:7},{name:"Denmiel Archives",price:function(e){return"full_unlock"===e.gawnfallMother?15e4:25e4},profits:2e4,social:1},{name:"Tak'Kan Mine",price:function(e){var t=e.gawnfallTakkan;return"major"===t?25e4:"minor"===t?5e5:1/0},profits:125e3,social:1,takkan:5},{name:"Ivalan Bank",price:k(55e4),profits:225e3},{name:"Mercenary Flotilla",price:k(5e5),profits:25e3},{name:"Sanitation Mages Guild",price:k(1e5),profits:5e3},{name:"Crystal Refiner",price:k(4e5),profits:55e3},{name:"Ardford Restaurant",price:k(1e5),profits:function(e){var t=e.investments,n=e.previousInvestments,a=void 0===n?[]:n;return y(e)&&[].concat(Object(m.a)(a),Object(m.a)(t.map((function(e){return e.name})))).includes("Givini Teahouse Chain")?25e3:1e4}}]),w=x,I=n(3),T=function(e){var t,n=e.name,r=e.label,i=e.tooltip,s=e.purchased,o=e.form,l=e.list;return Object(a.useEffect)((function(){o.setFieldsValue(Object(O.a)({},n,o.getFieldValue(n).filter((function(e){return!s.includes(e)}))))}),[o,s,n]),Object(I.jsx)(v.a.Item,{label:r,name:n,tooltip:i,children:Object(I.jsx)(b.a,{options:(t=l,"gawnfall"===t?S:x).filter((function(e){var t=e.name;return!s.includes(t)})).sort((function(e,t){var n=e.name,a=t.name;return n.localeCompare(a)})).map((function(e){var t=e.name;return{label:t,value:t}})),mode:"multiple"})})},C=function(e){var t=e.purchased,n=e.form,a=e.list,r=e.tooltip;return Object(I.jsx)(T,{form:n,purchased:t,label:"Investments you explicitly refuse to buy, for any reason",name:"banned",tooltip:r,list:a})},M=function(e){var t=e.form,n=e.purchased,a=e.tooltip,r=e.label,i=e.list;return Object(I.jsx)(T,{name:"mandatory",form:t,purchased:n,label:r||"Investments you explicitly want to buy, for any reason",tooltip:a,list:i})},R=h.a.Title,G=["Min's Trade Route","Yhilini Succubi Trade","Yhilini Bank Core Lender","Mercenary Offices","Theltiar Rentals","Theltiar Flowhouse","Denmiel Mushrooms","Denmiel Archives","Eustrin Guild","Gasm Falls Trade","Premium Steel Owner","Ivalan Bank","Mercenary Flotilla","Sanitation Mages Guild","Crystal Refiner","Ardford Restaurant"],N={previous:["Premium Steel Owner","Min's Trade Route","Yhilini Succubi Trade","Eustrin Guild","Denmiel Mushrooms","Ivalan Bank","Crystal Refiner","Ardford Restaurant"],remainingPron:7500,baseProfit:2435e3,chapter1Steel:!1,strategy:"compromise",startingSocial:34,chapter3Infrastructure:!0,merchantSolution:"wait",jhenno:"religion",magicalItems:"givini",mandatory:["Givini Orc Merchant","Bank of Givini"],research:"orc",banned:["Orcish Drake Statue + Orcish Gargoyle Statue + Orcish Golden Drake Statue"]},P={required:!0,message:"Please provide a value."},F=function(e){var t,n=e.onFinish,r=e.loading,i=v.a.useForm(),s=Object(o.a)(i,1)[0],l=Object(a.useState)(N.previous),c=Object(o.a)(l,2),u=c[0],d=c[1],h=Object(a.useState)(N.mandatory),O=Object(o.a)(h,2),x=O[0],y=O[1],k=Object(a.useState)(N.strategy),S=Object(o.a)(k,2),w=S[0],T=S[1];return Object(a.useEffect)((function(){["social","succession"].includes(w)?"wait"===s.getFieldValue("merchantSolution")&&s.setFieldsValue({merchantSolution:"neutral"}):"neutral"===s.getFieldValue("merchantSolution")&&s.setFieldsValue({merchantSolution:"wait"})}),[s,w]),Object(I.jsxs)(v.a,{initialValues:N,onFinish:n,onValuesChange:function(e,t){d(t.previous),y(t.mandatory),T(t.strategy)},className:"round-form first-round-form",form:s,children:[Object(I.jsxs)("div",{className:"past-block",children:[Object(I.jsx)(R,{level:2,children:"Chapters 1-3"}),Object(I.jsxs)(p.a,{children:[Object(I.jsxs)("div",{className:"numbers",children:[Object(I.jsx)(v.a.Item,{label:"ProN remaining at the end of chapter 3",name:"remainingPron",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "ProN available".',rules:[P],children:Object(I.jsx)(f.a,{})}),Object(I.jsx)(v.a.Item,{label:"Total profit at the start of chapter 4",name:"baseProfit",tooltip:'In the Calculator, go to "First Tower Run and Investment and copy the value next to "Total ProN Return".',rules:[P],children:Object(I.jsx)(f.a,{})}),Object(I.jsx)(v.a.Item,{label:"Your social standing at the start of chapter 4",name:"startingSocial",tooltip:'In the Calculator, go to "War Investment Phase" and copy the value next to "Social Score".',rules:[P],children:Object(I.jsx)(f.a,{})})]}),Object(I.jsx)(v.a.Item,{label:"Investments already bought during chapters 2/3",name:"previous",children:Object(I.jsx)(b.a,{options:(t=G,Object(m.a)(t).sort().map((function(e){return{label:e,value:e}}))),mode:"multiple"})}),Object(I.jsxs)("div",{className:"checkboxes",children:[!u.includes("Premium Steel Owner")&&Object(I.jsx)(v.a.Item,{name:"chapter1Steel",valuePropName:"checked",children:Object(I.jsx)(j.a,{children:"You invested 20,000 ProN in Premium Steel during chapter 1."})}),!(u.includes("Yhilini Succubi Trade")&&u.includes("Mercenary Offices"))&&Object(I.jsx)(v.a.Item,{name:"chapter3Infrastructure",valuePropName:"checked",children:Object(I.jsx)(j.a,{children:"You funded Yhilin Infrastructure during chapter 3."})})]})]})]}),Object(I.jsx)(R,{level:2,children:"Chapter 4 \u2013 Round 1"}),Object(I.jsxs)(p.a,{title:"Strategy",children:[Object(I.jsx)(v.a.Item,{name:"strategy",label:"Succession crisis",children:Object(I.jsx)(b.a,{options:[{label:"Focus on profits; do only the bare minimum for the Ardan succession crisis (New Givini \u2265 25).",value:"money"},{label:"Reach most thresholds for the Ardan succession crisis while keeping a focus on profits (New Givini \u2265 25, Social \u2265 30).",value:"compromise"},{label:"Mix profits and social to achieve almost everything in the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40).",value:"social"},{label:"Go all in on the Ardan succession crisis (New Givini \u2265 25, Social \u2265 40, War Monument or Givini Mage Guild).",value:"succession"}]})}),Object(I.jsx)("div",{className:"selects",children:Object(I.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution",children:Object(I.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})})}),Object(I.jsxs)("div",{className:"selects",children:[Object(I.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(I.jsx)(b.a,{options:[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}]})}),Object(I.jsx)(v.a.Item,{label:"Jhenno's cooperation",name:"jhenno",children:Object(I.jsx)(b.a,{options:[{value:"politics",label:"Politics"},{value:"religion",label:"Religion"}]})}),Object(I.jsx)(v.a.Item,{label:"Rose's house magical items",name:"magicalItems",children:Object(I.jsx)(b.a,{options:[{value:"givini",label:"Givini"},{value:"takkan",label:"Tak'Kan"}]})})]}),Object(I.jsx)(M,{purchased:u,form:s,tooltip:"Forcing a few certain investments can improve performances tremendously."}),Object(I.jsx)(C,{purchased:[].concat(Object(m.a)(u),Object(m.a)(x)),form:s,tooltip:Object(I.jsxs)(I.Fragment,{children:["For cases where a particular investment might be more of a curse than a blessing in the long run and you want to see what happens without it.",Object(I.jsx)("br",{}),"Banning an investment that you know to be useless at that particular point can also improve performances quite a bit, especially if said investment is cheap."]})}),Object(I.jsx)(v.a.Item,{children:Object(I.jsx)(g.a,{type:"primary",htmlType:"submit",loading:r,children:"Submit"})})]})]})},A=n(133),E=n(247),D=function(e){var t=e.initialStandings,n=e.investmentChanges,a=e.nonInvestmentChanges,r={};return["profits","givini","social","takkan"].forEach((function(e){r[e]=t[e]+(n[e]||0)+(a[e]||0)})),r.investments=[].concat(Object(m.a)(t.investments),Object(m.a)(n.investments.map((function(e){return e.name})))),r.money=t.money+t.profits-n.price+a.money,r},K=function(e){return e.toLocaleString("en-US")},B=120,V=function(e){var t=e.children,n=e.format?K(Math.abs(t)):Math.abs(t);return"".concat(t<0?"-":"+").concat(n)},L=function(e){var t=e.investments.map((function(e){var t=e.name,n=Object(A.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),n=[{title:"Name",dataIndex:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Price",dataIndex:"price",render:function(e){return K(e)},sorter:function(e,t){return e.price-t.price},width:B},{title:"Profits",dataIndex:"profits",render:function(e){return K(e)},sorter:function(e,t){return e.profits-t.profits},width:B},{title:"Social",dataIndex:"social",render:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(I.jsx)(V,{children:e})},width:B}];return Object(I.jsx)(E.a,{dataSource:t,columns:n,pagination:!1})},W=function(e){var t=e.list,n=(void 0===t?[]:t).map((function(e){var t=e.name,n=Object(A.a)(e,["name"]);return Object(d.a)({key:t,name:t},n)})),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Object(I.jsx)(V,{format:!0,children:e})},r=[{title:"Name",dataIndex:"name"},{title:"ProN",dataIndex:"money",render:a,width:B},{title:"Profits",dataIndex:"profits",render:a,width:B},{title:"Social",dataIndex:"social",render:a,width:B}];return Object(I.jsx)(E.a,{dataSource:n,columns:r,pagination:!1})},U=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,r=function(e,t){var n=t.key;return["base","total"].includes(n)?K(e):Object(I.jsx)(V,{format:!0,children:e})},i=[{dataIndex:"category"},{title:"ProN",dataIndex:"money",render:r,width:B},{title:"Profits",dataIndex:"profits",render:r,width:B},{title:"Social",dataIndex:"social",render:r,width:B}],s=function(e){return t[e]+n[e]+a[e]},o=a.profits-a.investments.reduce((function(e,t){return e+t.profits}),0),l=[Object(d.a)(Object(d.a)({},t),{},{key:"base",category:"Previously"}),{key:"previous_investments",category:"Start of the round",money:t.profits,profits:0,social:0},Object(d.a)(Object(d.a)({},a),{},{key:"investments",category:"Changes from new investments",money:-a.price,profits:a.profits-o}),Object(d.a)(Object(d.a)({},n),{},{key:"other",category:"Other changes",profits:n.profits+o})],c=o>0?[].concat(Object(m.a)(n.list),[{name:"Extra profits from past investments",profits:o}]):n.list;return Object(I.jsx)(E.a,{dataSource:l,columns:i,pagination:!1,bordered:!0,expandable:{expandedRowRender:function(e){var t=e.key;return"investments"===t?Object(I.jsx)(L,{investments:a.investments}):"other"===t?Object(I.jsx)(W,{list:c}):null},rowExpandable:function(e){var t,a=e.key;return"investments"===a||!("other"!==a||!(null===(t=n.list)||void 0===t?void 0:t.length))},defaultExpandAllRows:!0},summary:function(){return Object(I.jsxs)(E.a.Summary.Row,{children:[Object(I.jsx)(E.a.Summary.Cell,{colSpan:2,children:"Standings at the end of the round"}),Object(I.jsx)(E.a.Summary.Cell,{children:K(t.money+t.profits+n.money-a.price)}),Object(I.jsx)(E.a.Summary.Cell,{children:K(s("profits"))}),Object(I.jsx)(E.a.Summary.Cell,{children:s("social")})]})},className:"ledger"})},q=function(e){var t=e.startingValue,n=void 0===t?0:t,a=e.dataSources;return Object(I.jsxs)("table",{className:"addition",children:[Object(I.jsx)("tbody",{children:Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{children:"Initial value"}),Object(I.jsx)("td",{children:n}),Object(I.jsx)("td",{})]})}),a.filter((function(e){return e.dataSource.length>0})).map((function(e,t){var n=e.title,a=e.dataSource;return Object(I.jsxs)("tbody",{children:[Object(I.jsx)("tr",{children:Object(I.jsx)("th",{colSpan:"3",scope:"col",children:n})}),a.map((function(e,t){var n=e.label,a=e.values,r=e.explanation;return Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{children:n}),Object(I.jsx)("td",{children:a.map((function(e){return"+".concat(e)})).join(" ")}),Object(I.jsx)("td",{children:r})]},t.toString())}))]},t.toString())})),Object(I.jsx)("tfoot",{children:Object(I.jsxs)("tr",{children:[Object(I.jsx)("th",{scope:"row",children:"Total"}),Object(I.jsx)("td",{children:n+a.reduce((function(e,t){return e+t.dataSource.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}))}),0)}),0)})]})})]})},H=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},_=function(e){return[{label:"Petitions",values:[5,5,2,2,2]},{label:"New Givini Trade",values:[5],explanation:"On purchase"},e.investments.includes("Min's Trade Route")&&{label:"Min's Trade Route",values:[1]}].filter(Boolean)},Y=function(e){var t=e.chapter3Investments;return-5+H(_({investments:t}))},J=function(e){var t=e.merchantSolution;return["givini"===e.magicalItems&&{label:"House Rose's magical items: Givini",values:[2]},"neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"Givino Vinai equipment shop girl",values:[1]},{label:"Givini king",values:[1]},{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},z=function(){return H(J.apply(void 0,arguments))},Q=function(e){var t=e.merchantSolution2;return["neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},X=function(){return H(Q.apply(void 0,arguments))},Z=function(e){var t=e.merchantSolution3,n=e.gawnfallTakkan,a=e.gawnfallMercantile;return["neutral"===t&&{label:"Merchant dispute: Neutral compromise",values:[1]},"givini"===t&&{label:"Merchant dispute: Favor New Givini",values:[2]},"major"===n&&{label:"Gawnfall: Tak'Kan vote",values:[1]},["excellent","good"].includes(a)&&{label:"Gawnfall: Mercantile solution",values:[1]},{label:"New Givini Trade",values:[1],explanation:"At the end of the round (before profits from the Givini Orc Merchant are computed)"}].filter(Boolean)},$=function(){return H(Z.apply(void 0,arguments))},ee=function(e){var t=e.chapter3Investments,n=void 0===t?[]:t,a=e.roundOneInvestments,r=void 0===a?[]:a,i=e.decisions,s=void 0===i?{}:i;return Object(I.jsx)(q,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:_({investments:n})},{title:"Investments",dataSource:r.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:J(s)}]})},te=function(e){return e.reduce((function(e,t){return e+t.values.reduce((function(e,t){return e+t}),0)}),0)},ne=function(e){return["takkan"===e.magicalItems&&{label:"House Rose's magical items: Tak'Kan",values:[2]},{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===e.research&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},ae=function(){return te(ne.apply(void 0,arguments))},re=function(e){return[{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===e.research&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},ie=function(){return te(re.apply(void 0,arguments))},se=function(e){var t=e.research,n=e.gawnfallMercantile,a=e.gawnfallTakkan;return["minor"===a&&{label:"Gawnfall: Tak'Kan vote",values:[2]},"major"===a&&{label:"Gawnfall: Tak'Kan vote",values:[5]},["excellent","good"].includes(n)&&{label:"Gawnfall: Mercantile solution",values:[1]},{label:"Tak'Kan Trade",values:[1],explanation:"At the end of the round"},"orc"===t&&{label:"Research: Orc Diversification",values:[5]}].filter(Boolean)},oe=function(){return te(se.apply(void 0,arguments))},le=function(e){var t=e.roundOneInvestments,n=void 0===t?[]:t,a=e.decisions,r=void 0===a?{}:a;return Object(I.jsx)(q,{startingValue:-5,dataSources:[{title:"Chapter start",dataSource:[{label:"Petitions",values:[5,2,2,5]},{label:"Tak'Kan Trade",values:[5],explanation:"On purchase"}]},{title:"Investments",dataSource:n.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:ne(r)}]})},ce=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,r=e.decisions;return Object(I.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(I.jsx)(U,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(I.jsxs)("div",{children:[Object(I.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(I.jsx)(ee,{chapter3Investments:t.investments,roundOneInvestments:a.investments,decisions:r})}),Object(I.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(I.jsx)(le,{roundOneInvestments:a.investments,decisions:r})})]})]})},ue=function(e){var t=e.children,n=e.data,r=Object(a.useRef)(null);return Object(a.useEffect)((function(){n&&r.current&&r.current.scrollIntoView({behavior:"smooth"})}),[n,r]),n?Object(I.jsx)("div",{ref:r,children:t}):null},de=function(e,t){var n=t.strategy,a=t.jhenno,r=t.merchantSolution;return"money"===n?0:"neutral"===r?40-e:("compromise"===n?30:40)-(e+("politics"===a?1:0))},me=function(e){var t=["politics"===e.jhenno&&{name:"Jhenno's political cooperation",social:1},{name:"Succession crisis' reward (best result)",social:3},{name:"The Three Trades become less profitable",profits:-3e5}].filter(Boolean);return{givini:z(e),takkan:ae(e),money:0,profits:t.reduce((function(e,t){var n=t.profits;return e+(void 0===n?0:n)}),0),social:t.reduce((function(e,t){var n=t.social;return e+(void 0===n?0:n)}),0),list:t}},he=function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,r,i,s,o,l,u,m,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.runInWoker,a=t.initialStandings,r=t.decisions,i=t.nonInvestmentChanges,s=t.mandatory,o=t.misc,l=t.banned,u=a.givini,m=i.givini,h=Object(d.a)(Object(d.a)({},o),{},{previousInvestments:a.investments,money:a.money+a.profits,otherRequirements:{social:de(a.social,r),givini:(c={giviniStart:u,giviniExtra:m},25-c.giviniStart-c.giviniExtra+3),mandatory:s,atLeastOne:"succession"===r.strategy?["War Monument","Givini Mage Guild"]:void 0,banned:l},giviniStart:u,giviniExtra:m}),e.abrupt("return",n(h));case 5:case"end":return e.stop()}var c}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,r,i,s,o,l,u,m,h,v,p,f,b,j,g,O,x,y,k,S,w,I,T;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,a=t.setResult,r=t.runInWoker,(i=t.setError)(void 0),s=n.previous,o=void 0===s?[]:s,l=n.remainingPron,u=n.baseProfit,m=n.startingSocial,h=n.strategy,v=n.merchantSolution,p=n.jhenno,f=n.magicalItems,b=n.research,j=n.mandatory,g=n.banned,O=n.chapter1Steel,x=n.chapter3Infrastructure,y={money:l,profits:u,investments:o,social:m,givini:Y({chapter3Investments:o}),takkan:-5+te([{label:"Petitions",values:[5,2,2,5]},{label:"Tak'Kan Trade",values:[5],explanation:"On purchase"}])},S={chapter1Steel:O,chapter3Infrastructure:x},w=me(k={strategy:h,merchantSolution:v,magicalItems:f,research:b,jhenno:p}),e.next=9,he({runInWoker:r,initialStandings:y,decisions:k,nonInvestmentChanges:w,mandatory:j,misc:S,banned:g});case 9:if(I=e.sent){e.next=14;break}return a(void 0),i("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 14:T=Object(d.a)(Object(d.a)({},I),{},{money:-I.price}),a({initialStandings:y,decisions:k,nonInvestmentChanges:w,investmentChanges:T,finalStandings:D({initialStandings:y,nonInvestmentChanges:w,investmentChanges:T}),misc:S}),i(void 0);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(e){var t=e.runInWoker,n=e.loading,a=e.result,r=e.setResult,i=e.setError;return Object(I.jsxs)("div",{className:"round-one",children:[Object(I.jsx)(F,{onFinish:function(e){ve({values:e,setResult:r,runInWoker:t,setError:i})},loading:n}),Object(I.jsx)(ue,{data:a,children:Object(I.jsx)(ce,Object(d.a)({},a))})]})},fe=n(132),be=n.n(fe),je=n(256),ge=h.a.Title,Oe=function(){return Object(I.jsxs)("div",{className:"disclaimer",children:[Object(I.jsxs)("div",{className:"preamble",children:[Object(I.jsx)(ge,{children:"Investment Advisor"}),Object(I.jsxs)("p",{children:["A tool to help you choose the best theoretical best possible investments for chapter 4 of ",Object(I.jsx)("a",{href:"https://the-last-sovereign.blogspot.com/",children:"The Last Sovereign"}),"."]}),Object(I.jsx)("p",{children:"Just fill in the requested information, choose your strategy and let a quasi-brute force algorithm determine what's best for you (assuming a definition of best here as highest short term returns, then lowest price, while still fulfilling the requirements of your strategy)."}),Object(I.jsxs)("p",{children:["This is definetely an advanced tool, intended for people who are already familiar with the game's ",Object(I.jsx)("a",{href:"https://thelastsovereign.miraheze.org/wiki/Secret_stats",children:"inner workings"}),", with the awesome ",Object(I.jsx)("a",{href:"https://thelastsovereign.flarum.cloud/d/15-calculator",children:"Calculator"}),", and are now looking for the last lousy optimizations they might have missed."]})]}),Object(I.jsx)(je.a,{message:"Assumptions",description:Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("p",{children:Object(I.jsx)("a",{href:"https://www.patreon.com/posts/demographics-8851324",children:"About 85% of players have only ever played TLS with Reshaped Varia."})}),Object(I.jsx)("p",{children:'That means if I was to write a walkthrough for TLS that only covered a "Reshaped Varia" strategy, it\'ll still be usable by 85% of players. Of course, I will have to release a "Dominated Varia" variant eventually to account for the remaining 15%. But in the meantime, that\'s already 85% of people that can start playing with my walkthrough without waiting any further. Meanwhile, if I had tried to cover both cases from the start, 100% of people would have had to wait.'}),Object(I.jsx)("p",{children:'While I\'m writing a software and not a walkthrough here, it will play by the same logic: Focus first on the "general case", by making a few (many) assumptions that hopefully will be true of most "good" saves, so to be able to release it to the public early. Then slowly cover the other cases in subsequent updates.'}),Object(I.jsx)("p",{children:"Therefore, at the moment, this tool takes for granted that:"}),Object(I.jsxs)("ol",{children:[Object(I.jsx)("li",{children:"The Succubus Tower was visited during chapter 1."}),Object(I.jsx)("li",{children:"Simon invested in the bank during chapter 1."}),Object(I.jsx)("li",{children:"The Iron Cudgel was hired (in either chapter 1 or 2)."}),Object(I.jsx)("li",{children:"Through chapter 2, the AriGarda was bribed, the Merchant's Guild joined, the Order of Silence funded, and the Ardan Bank invested into."}),Object(I.jsx)("li",{children:"Tradesmasher and the Succubus Armorer were met during chapter 3."}),Object(I.jsx)("li",{children:"The three unique Trades (New Givini, Tak'Kan and Chalice States) were bought at the end of chapter 3."}),Object(I.jsx)("li",{children:"Chapter 3 in general was good enough for Yhilin to reach its final state during the first investment phase of Chapter 4."}),Object(I.jsx)("li",{children:"Chapter 3 in general and the war in particular were good enough for all petitions favorable to Givini to appear."}),Object(I.jsx)("li",{children:"All such petitions were approved."})]}),Object(I.jsx)("p",{children:'Note that the final version of the advisor will likely still have a few assumptions in it, so as to keep the complexity in check. Namely, "disaster runs" will never be covered.'}),Object(I.jsx)("p",{children:"tl;dr The Advisor is currently in early access."})]}),type:"info",showIcon:!0,className:"assumptions",closable:!0})]})},xe=n(254),ye=n(253),ke=n(246),Se=n(250),we=function(e){var t=e.combinationsCount,n=e.progress,a=e.investmentsCount,r=e.preprogress,i=e.abort;return a?Object(I.jsxs)(xe.a,{visible:!0,centered:!0,closable:!1,footer:null,children:[Object(I.jsxs)("div",{children:[Object(I.jsxs)("p",{children:["Prefiltering ".concat(Math.pow(2,a).toLocaleString("en-US")," (2"),Object(I.jsx)("sup",{children:a}),") possibilities\u2026"]}),Object(I.jsx)(ye.a,{percent:Math.round(100*r)})]}),!!t&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(ke.a,{}),Object(I.jsxs)("div",{children:[Object(I.jsx)("p",{children:"Processing ".concat(t.toLocaleString("en-US")," remaining possibilities\u2026")}),Object(I.jsx)(ye.a,{percent:Math.round(1e4*n)/100})]})]}),Object(I.jsx)(g.a,{danger:!0,icon:Object(I.jsx)(Se.a,{}),onClick:i,className:"abort-button",children:"Abort"})]}):null},Ie=n(255),Te=function(e){var t=e.message;return Object(I.jsx)(p.a,{children:Object(I.jsx)(Ie.a,{status:"warning",title:t})})},Ce=[{key:"Tower Little Girl talk",magic:1,military:0,price:0},{key:"Deluxe Givini Dragon Statue",magic:1,military:0,price:5e3},{key:"HQ Shrine",magic:1,military:0,price:5e3},{key:"Orc Lab Upgrade",magic:2,military:5,price:25e3},{key:"Magical Shielding Upgrade",magic:5,military:0,price:1e5}],Me=[{key:"Research: Base Defense",military:5,magic:10,price:0}],Re=[{key:"Wynn's Shield Upgrade",magic:5,military:0,price:1e5},{key:"Extradimensional Foundation",magic:5,military:5,price:225e3}],Ge=[{key:"Armory Upgrade",military:5,magic:0,price:1e4},{key:"Orc Guard Posts",military:3,magic:0,price:5e3},{key:"Supplies Upgrade",military:2,magic:0,price:1e4}],Ne=[{key:"Armory Upgrade",military:5,magic:0,price:1e4},{key:"Orc Guard Posts",military:3,magic:0,price:5e3},{key:"Second Well",military:3,magic:0,price:1e4},{key:"Iron Cudgel",military:4,magic:0,price:15e3}],Pe=function(e){return"+".concat(e)},Fe=[{title:"Upgrade",dataIndex:"key"},{title:"Price",dataIndex:"price",render:function(e){return K(e)},sorter:function(e,t){return e.price-t.price}},{title:"Military",dataIndex:"military",render:Pe,sorter:function(e,t){return e.military-t.military}},{title:"Magic",dataIndex:"magic",render:Pe,sorter:function(e,t){return e.magic-t.magic}}],Ae=function(e){var t=e.research,n=e.military,a=e.magic;if("defense"===t){if(n<=10&&20===a)return[].concat(Me,Ce);if(20===n&&a<=10)return[].concat(Me,Ne);if(20===n&&20===a)return[].concat(Me,Ce,Ge)}if(n<=10&&20===a)return[].concat(Ce,Re);if(20===n&&a<=10)return[].concat(Ce,Ne);if(20===n&&20===a)return[].concat(Ce,Re,Ge);throw new Error("Unsupported")},Ee=function(e,t){return e.reduce((function(e,n){return e+n[t]}),0)},De=function(e){return Ee(Ae(e),"price")},Ke=function(e){var t=e.research,n=e.military,a=e.magic,r=Ae({research:t,military:n,magic:a});return Object(I.jsx)("div",{className:"headquarters-upgrades",children:Object(I.jsx)(E.a,{dataSource:r,columns:Fe,pagination:!1,summary:function(){return Object(I.jsxs)(E.a.Summary.Row,{children:[Object(I.jsx)(E.a.Summary.Cell,{children:"Total"}),Object(I.jsx)(E.a.Summary.Cell,{children:K(Ee(r,"price"))}),Object(I.jsx)(E.a.Summary.Cell,{children:Ee(r,"military")}),Object(I.jsx)(E.a.Summary.Cell,{children:Ee(r,"magic")})]})}})})},Be={merchantSolution2:"neutral",headquarters:"20/10",orcCouncil:.8,mandatory:[],banned:[]},Ve=function(e){var t=e.onFinish,n=e.loading,r=e.firstRoundDecisions,i=e.purchasedInvestments,s=v.a.useForm(),l=Object(o.a)(s,1)[0],c=Object(a.useState)(Be.headquarters),u=Object(o.a)(c,2),d=u[0],h=u[1],f=d.split("/").map((function(e){return parseInt(e)})),j=Object(o.a)(f,2),O=j[0],x=j[1],y=Object(a.useState)(Be.mandatory),k=Object(o.a)(y,2),S=k[0],w=k[1],T=r.research;return Object(a.useEffect)((function(){l.setFieldsValue({research:"purity"===T?"orc":"purity"})}),[l,T]),Object(I.jsx)(v.a,{initialValues:Be,onFinish:t,className:"round-form second-round-form",form:l,onValuesChange:function(e,t){h(t.headquarters),w(t.mandatory)},children:Object(I.jsxs)(p.a,{title:"Stategy",type:"inner",children:[Object(I.jsxs)("div",{className:"two-columns",children:[Object(I.jsxs)("div",{children:["wait"===r.merchantSolution&&Object(I.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution2",children:Object(I.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})}),Object(I.jsx)(v.a.Item,{name:"orcCouncil",label:"Orc council",children:Object(I.jsx)(b.a,{options:[{label:"Substantial majority (\u2265 65%)",value:.65},{label:"Overwhelming majority (\u2265 80%)",value:.8}]})}),Object(I.jsx)(v.a.Item,{name:"headquarters",label:"Headquarters",children:Object(I.jsx)(b.a,{options:[{label:"Pay ".concat(K(De({research:T,military:20,magic:10}))," ProN for Military \u2265 20, Magic \u2265 10."),value:"20/10"},{label:"Pay ".concat(K(De({research:T,military:5,magic:20}))," ProN for Military \u2265 5, Magic \u2265 20."),value:"5/20"},{label:"Pay ".concat(K(De({research:T,military:20,magic:20}))," ProN for Military \u2265 20, Magic \u2265 20."),value:"20/20"}]})}),Object(I.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(I.jsx)(b.a,{options:[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}].filter((function(e){return e.value!==T}))})}),Object(I.jsx)(M,{label:"Investments you explicitly want to buy now (example: Airships)",form:l,purchased:i}),Object(I.jsx)(C,{purchased:[].concat(Object(m.a)(i),Object(m.a)(S)),form:l})]}),Object(I.jsx)(Ke,{research:T,military:O,magic:x})]}),Object(I.jsx)(v.a.Item,{children:Object(I.jsx)(g.a,{type:"primary",htmlType:"submit",loading:n,children:"Submit"})})]})})},Le=function(e){var t=e.startingValue,n=e.roundTwoInvestments,a=void 0===n?[]:n,r=e.decisions,i=void 0===r?{}:r;return Object(I.jsx)(q,{startingValue:t,dataSources:[{title:"Investments",dataSource:a.filter((function(e){var t=e.givini;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.givini]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:Q(i)}]})},We=h.a.Text,Ue=function(e){var t=e.startingValue,n=e.roundTwoInvestments,a=void 0===n?[]:n,r=e.decisions,i=void 0===r?{}:r,s=e.roundOneResearch,o=e.previousInvestments,l=void 0===o?[]:o,c=e.takkanScore,u=function(e){var t=e.investments,n=void 0===t?[]:t,a=e.takkan,r=e.researches,i=5,s=2;return a>=40?i+=4:a>=30?(i+=3,s+=1):a>=20?(i+=2,s+=2):a>=10?(i+=1,s+=3):s+=4,(void 0===r?[]:r).includes("orc")?i+=1:s+=1,i+=n.filter((function(e){return["Orc Pools Upgrade","Tarran'Kan Housing + Tarran'Kan Trade Upgrade","Hall of Mental Strength","Imp Offices"].includes(e)})).length,n.includes("Orcish Democracy")&&(i=2),i/(i+s)}({researches:[s],investments:[].concat(Object(m.a)(l),Object(m.a)(a.map((function(e){return e.name})))),takkan:c});return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(q,{startingValue:t,dataSources:[{title:"Investments",dataSource:a.filter((function(e){var t=e.takkan;return 0!==(void 0===t?0:t)})).map((function(e){return{label:e.name,values:[e.takkan]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},{title:"Other changes",dataSource:re(i)}]}),Object(I.jsxs)(We,{children:["Orc council: ",Object(I.jsxs)(We,{type:u>=.8?"success":"warning",children:[(100*u).toFixed(2),"%"]})]})]})},qe=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,r=e.decisions,i=e.roundOneDecisions;return Object(I.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(I.jsx)(U,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(I.jsxs)("div",{children:[Object(I.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(I.jsx)(Le,{startingValue:t.givini,roundTwoInvestments:a.investments,decisions:r})}),Object(I.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(I.jsx)(Ue,{startingValue:t.takkan,roundTwoInvestments:a.investments,decisions:r,takkanScore:t.takkan+a.takkan,roundOneResearch:i.research,previousInvestments:t.investments})})]})]})},He=h.a.Title,_e=function(e,t){return"neutral"===t.merchantSolution2&&e<40?40-e:0},Ye=function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,r,i,s,l,u,m,h,v,p,f,b,j,g,O,x,y,k,S,w,I,T;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.setResult,a=t.runInWoker,r=t.setError,i=t.firstRoundResult,s=t.values,l=i.finalStandings,u=i.misc,m=s.merchantSolution2,h=s.headquarters,v=s.orcCouncil,p=s.mandatory,f=s.banned,b=s.research,g=(j={merchantSolution2:m,headquarters:h,orcCouncil:v,research:b}).headquarters.split("/").map((function(e){return parseInt(e)})),O=Object(o.a)(g,2),x=O[0],y=O[1],k=De({research:i.decisions.research,military:x,magic:y}),S={money:-k,profits:0,social:0,givini:X(j),takkan:ie(j),list:[{name:"Headquarters upgrades",money:-k}]},w=Object(d.a)(Object(d.a)({},u),{},{previousInvestments:l.investments,money:l.money+l.profits-k,giviniStart:l.givini,giviniExtra:S.givini,takkan:l.takkan,completedResearch:[i.decisions.research],otherRequirements:{social:_e(l.social,j),orcCouncil:j.orcCouncil,mandatory:p,banned:f}}),e.next=10,a(w);case 10:if(I=e.sent){e.next=15;break}return n(void 0),r("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 15:T=Object(d.a)(Object(d.a)({},I),{},{money:-I.price}),n({initialStandings:l,decisions:j,nonInvestmentChanges:S,investmentChanges:T,finalStandings:D({initialStandings:l,nonInvestmentChanges:S,investmentChanges:T}),misc:u}),r(void 0);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Je=function(e){var t=e.runInWoker,n=e.loading,a=e.result,r=e.setResult,i=e.setError,s=e.firstRoundResult;return Object(I.jsxs)("div",{className:"round-two",children:[Object(I.jsx)(He,{level:2,children:"Chapter 4 \u2013 Round 2"}),Object(I.jsx)(Ve,{onFinish:function(e){Ye({setResult:r,runInWoker:t,setError:i,firstRoundResult:s,values:e})},loading:n,firstRoundDecisions:s.decisions,purchasedInvestments:s.finalStandings.investments}),Object(I.jsx)(ue,{data:a,children:Object(I.jsx)(qe,Object(d.a)({roundOneDecisions:s.decisions},a))})]})},ze=n(120),Qe={mandatory1:[],yelarel:"min",gawnfallTakkan:"major",gawnfallMercantile:"excellent",gawnfallArdford:"resolved",gawnfallMother:"full_unlock",vera:!1,merchantSolution3:"neutral",mandatory:[],banned:[],gawnfallHigh:"herin_overwhelming",reserves:5375e3,extra_reserves:0},Xe=function(e){var t=e.previousInvestments,n=e.previousResearch,r=e.onFinish,i=e.loading,s=e.merchantSolution,l=v.a.useForm(),c=Object(o.a)(l,1)[0],u=Object(a.useState)(Qe.mandatory1),d=Object(o.a)(u,2),h=d[0],j=d[1],O=Object(a.useState)(Qe.mandatory),x=Object(o.a)(O,2),y=x[0],k=x[1],T=Object(a.useState)([]),R=Object(o.a)(T,2),G=R[0],N=R[1],P=[{value:"orc",label:"Orc Diversification"},{value:"unpeople",label:"Unpeople Transformation"},{value:"purity",label:"Purity Magic"},{value:"defense",label:"Base Defense"}].filter((function(e){var t=e.value;return!n.includes(t)}));return Object(a.useEffect)((function(){c.setFieldsValue({research:P[0].value})}),[c,P]),Object(I.jsxs)(v.a,{initialValues:Qe,className:"round-form third-round-form",form:c,onFinish:r,onValuesChange:function(e,n){j(n.mandatory1),k(n.mandatory),N(S.filter((function(e){var a=e.name,r=e.price;return!t.includes(a)&&("function"===typeof r&&r(n)===1/0)})).map((function(e){return e.name})))},children:[Object(I.jsx)(p.a,{title:"Gawnfall",type:"inner",className:"gawnfall",children:Object(I.jsxs)("div",{className:"two-columns",children:[Object(I.jsxs)(p.a,{title:"Strategy",type:"inner",children:[!s&&Object(I.jsx)(v.a.Item,{label:"Merchant dispute",name:"merchantSolution3",children:Object(I.jsx)(b.a,{options:[{value:"neutral",label:"Neutral compromise (force Social \u2265 40)"},{value:"givini",label:"Favor New Givini"},{value:"wait",label:"Wait"}]})}),Object(I.jsx)(v.a.Item,{label:"Research",name:"research",children:Object(I.jsx)(b.a,{options:P})}),!t.includes("Lustlord Temples")&&Object(I.jsx)(v.a.Item,{label:"Yelarel-related investments",name:"yelarel",children:Object(I.jsx)(ze.a.Group,{options:[{value:"min",label:"Pay 50,000 for New Lustlord Statues"},{value:"max",label:"Invest 800,000 (total) in the Lustlord Temples"}]})}),Object(I.jsx)(v.a.Item,{label:"Buy Goddess of Magic Statue?",name:"vera",children:Object(I.jsx)(ze.a.Group,{options:[{value:!0,label:"Yes"},{value:!1,label:"No"}]})}),Object(I.jsx)(v.a.Item,{label:"Other investments you wish to do before the Council (example: Givini Tunnels)",name:"mandatory1",children:Object(I.jsx)(b.a,{options:w.filter((function(e){var n=e.name;return!t.includes(n)&&"Lustlord Temples"!==n&&!["Denmiel Archives","Tarran'Kan Housing + Tarran'Kan Trade Upgrade"].includes(n)})).map((function(e){var t=e.name;return{label:t,value:t}})),mode:"multiple"})})]}),Object(I.jsxs)(p.a,{title:"Investments-related results",type:"inner",children:[Object(I.jsx)(je.a,{message:"Only the Succubi Accepted path is supported as of now.",type:"info",showIcon:!0}),Object(I.jsx)(v.a.Item,{label:"Support for Tak'Kan",name:"gawnfallTakkan",children:Object(I.jsx)(b.a,{options:[{value:"major",label:"Major"},{value:"minor",label:"Minor"},{value:"none",label:"None"}]})}),Object(I.jsx)(v.a.Item,{label:"Promotion vote",name:"gawnfallHigh",children:Object(I.jsx)(b.a,{options:[{value:"herin_overwhelming",label:"Overwhelming victory for Herin"},{value:"herin_promoted",label:"Herin promoted"},{value:"kaskia_promoted",label:"Kaskia promoted"},{value:"kaskia_overwhelming",label:"Overwhelming victory for Kaskia"}]})}),Object(I.jsx)(v.a.Item,{label:"Mercantile issue resolution",name:"gawnfallMercantile",children:Object(I.jsx)(b.a,{options:[{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}]})}),Object(I.jsx)(v.a.Item,{label:"Ardford's ban",name:"gawnfallArdford",children:Object(I.jsx)(b.a,{options:[{value:"overkill",label:"Lifted, with an extra bit of acceptance"},{value:"resolved",label:"Lifted"},{value:"unresolved",label:"Unsolved"}]})}),Object(I.jsx)(v.a.Item,{label:"Mother's Guard",name:"gawnfallMother",children:Object(I.jsx)(b.a,{options:[{value:"full_unlock",label:"Crushed"},{value:"partial_unlock",label:"Dealt with"},{value:"locked",label:"Unrestrained"}]})})]})]})}),Object(I.jsxs)(p.a,{title:"Post Gawnfall",type:"inner",children:[Object(I.jsxs)("div",{className:"reserves",children:[Object(I.jsx)(v.a.Item,{label:"Keep enough cash in reserve, if need be, to:",name:"reserves",children:Object(I.jsx)(b.a,{options:[{label:"Open the ruins after the war",value:0},{label:"Open the ruins before the war (".concat(K(5e6)," ProN)"),value:5e6},{label:"Open the ruins and buy everything but the Smithing in Kyangan (".concat(K(5125e3)," ProN)"),value:5125e3},{label:"Open the ruins and buy everything in Kyangan (".concat(K(5375e3)," ProN)"),value:5375e3}]})}),Object(I.jsx)(v.a.Item,{label:"Also make sure to have the additional amount available",name:"extra_reserves",tooltip:Object(I.jsxs)(I.Fragment,{children:["For extra expanses not covered in the previous option.",Object(I.jsx)("br",{}),"For example, if you also plan to buy Armory Upgrade and Entity's Shield Upgrade before the war, enter their total cost i.e. 260000."]}),children:Object(I.jsx)(f.a,{})})]}),Object(I.jsx)(M,{form:c,purchased:[].concat(Object(m.a)(t),Object(m.a)(h),Object(m.a)(G)),list:"gawnfall"}),Object(I.jsx)(C,{form:c,purchased:[].concat(Object(m.a)(t),Object(m.a)(h),Object(m.a)(y),Object(m.a)(G)),list:"gawnfall"})]}),Object(I.jsx)(v.a.Item,{children:Object(I.jsx)(g.a,{type:"primary",htmlType:"submit",loading:i,children:"Submit"})})]})},Ze=function(e,t){return e.filter((function(e){return!!e[t]})).map((function(e){return{label:e.name,values:[e[t]]}})).sort((function(e,t){var n=e.label,a=t.label;return n.localeCompare(a)}))},$e=function(e){var t=e.initialStandings,n=e.nonInvestmentChanges,a=e.investmentChanges,r=e.decisions,i=a.investments;return Object(I.jsxs)(p.a,{title:"Changes",className:"results",children:[Object(I.jsx)(U,{initialStandings:t,nonInvestmentChanges:n,investmentChanges:a}),Object(I.jsxs)("div",{children:[Object(I.jsx)(p.a,{title:"New Givini",type:"inner",children:Object(I.jsx)(q,{startingValue:t.givini,dataSources:[{title:"Investments",dataSource:Ze(i,"givini")},{title:"Other changes",dataSource:Z(r)}]})}),Object(I.jsx)(p.a,{title:"Tak'Kan",type:"inner",children:Object(I.jsx)(q,{startingValue:t.takkan,dataSources:[{title:"Investments",dataSource:Ze(i,"takkan")},{title:"Other changes",dataSource:se(r)}]})})]})]})},et=h.a.Title,tt=function(e){var t=e.gawnfallMother,n=e.gawnfallHigh,a=0;return"full_unlock"===t&&(a+=2),"partial_unlock"===t&&(a+=1),"herin_overwhelming"===n&&(a+=1),"kaskia_overwhelming"===n&&(a-=1),a},nt=function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,r,i,s,o,l,u,h,v,p,f,b,j,g,O,x,y,k,S,w,I,T,C,M,R,G,N,P,F,A,E,K,B;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.runInWoker,a=t.setResult,r=t.setError,i=t.secondRoundResult,s=t.values,o=i.finalStandings,l=s.research,u=s.mandatory1,h=s.yelarel,v=s.gawnfallTakkan,p=s.gawnfallMercantile,f=s.gawnfallArdford,b=s.gawnfallMother,j=s.vera,g=s.merchantSolution3,O=s.mandatory,x=s.banned,y=s.gawnfallHigh,k=s.reserves,S=s.extra_reserves,w={research:l,gawnfallTakkan:v,gawnfallMercantile:p,gawnfallArdford:f,gawnfallMother:b,merchantSolution3:g,gawnfallHigh:y},I=[].concat(Object(m.a)(u),Object(m.a)(O)),"max"===h&&I.push("Lustlord Temples"),T=Object(d.a)(Object(d.a)({},i.misc),{},{gawnfallTakkan:v,gawnfallMother:b,gawnfallArdford:f}),C=function(){switch(w.gawnfallMercantile){case"excellent":return 25e4;case"good":return 1e5;case"poor":return-1e5;default:return 0}}(),M=["resolved","overkill"].includes(w.gawnfallArdford),R=M&&o.investments.includes("Ardford Restaurant")&&o.investments.includes("Givini Teahouse Chain"),G=[{name:"New Lustlord Statues",money:-5e4},j&&{name:"Goddess of Magic Statue",money:-1e4},{name:"Gawnfall social influence",social:tt(w)},{name:"One-time mercantile issue modifier",profits:C}].filter(Boolean),N={money:G.reduce((function(e,t){return e+(t.money||0)}),0),profits:C,social:G.reduce((function(e,t){return e+(t.social||0)}),0),givini:$(w),takkan:oe(w),list:G},P=Object(d.a)(Object(d.a)({},T),{},{previousInvestments:o.investments,money:o.money+o.profits+N.money,giviniStart:o.givini,giviniExtra:N.givini,otherRequirements:{mandatory:I,banned:x,social:"neutral"===w.merchantSolution3?Math.max(40-o.social,0):0,reserve:k+S-(o.profits+N.profits)},list:"gawnfall"}),e.next=15,n(P);case 15:if(F=e.sent){e.next=20;break}return a(void 0),r("Couldn't find a working combination of investments for that strategy with these starting values, sorry."),e.abrupt("return");case 20:A=Object(d.a)(Object(d.a)({},F),{},{money:-F.price}),E=[].concat(Object(m.a)(o.investments),Object(m.a)(A.investments.map((function(e){return e.name})))),K=!R&&M&&E.includes("Ardford Restaurant")&&E.includes("Givini Teahouse Chain"),(R||K)&&(B={name:"Orri's Quest",social:1,profits:R?15e3:0},N.profits+=B.profits,N.list.push(B)),a({initialStandings:o,decisions:w,nonInvestmentChanges:N,investmentChanges:A,finalStandings:D({initialStandings:o,nonInvestmentChanges:N,investmentChanges:A}),misc:T}),r(void 0);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),at=function(e){var t=e.firstRoundResult,n=e.secondRoundResult,a=e.runInWoker,r=e.loading,i=e.setResult,s=e.setError,o=e.result,l=n.finalStandings.investments,c=[t.decisions.research,n.decisions.research],u="wait"!==t.decisions.merchantSolution?t.decisions.merchantSolution:"wait"!==n.decisions.merchantSolution2?n.decisions.merchantSolution2:void 0;return Object(I.jsxs)("div",{className:"round-three",children:[Object(I.jsx)(et,{level:2,children:"Chapter 4 \u2013 Round 3"}),Object(I.jsx)(Xe,{previousInvestments:l,previousResearch:c,onFinish:function(e){nt({runInWoker:a,setResult:i,setError:s,secondRoundResult:n,values:e})},loading:r,merchantSolution:u}),Object(I.jsx)(ue,{data:o,children:Object(I.jsx)($e,Object(d.a)({},o))})]})},rt={},it=function(e){return JSON.stringify(e)},st=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],d=s[1],m=Object(a.useState)(),h=Object(o.a)(m,2),v=h[0],p=h[1],f=Object(a.useState)(0),b=Object(o.a)(f,2),j=b[0],g=b[1],O=Object(a.useState)(),x=Object(o.a)(O,2),y=x[0],k=x[1],S=Object(a.useState)(0),w=Object(o.a)(S,2),T=w[0],C=w[1],M=Object(a.useState)(),R=Object(o.a)(M,2),G=R[0],N=R[1],P=Object(a.useState)(),F=Object(o.a)(P,2),A=F[0],E=F[1],D=Object(a.useState)(),K=Object(o.a)(D,2),B=K[0],V=K[1],L=Object(a.useState)(),W=Object(o.a)(L,2),U=W[0],q=W[1];if(Object(a.useEffect)((function(){return n||r(be()()),function(){null===n||void 0===n||n.terminate()}}),[n]),!n)return null;var H=function(e){var t=e.workerInstance,n=e.setLoading,a=e.setCombinationsCount,r=e.setProgress,i=e.setInvestmentsCount,s=e.setPreprogress;return function(){var e=Object(u.a)(c.a.mark((function e(o){var l,u,d,m,h,v,p,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=it(o),!rt[l]){e.next=3;break}return e.abrupt("return",rt[l]);case 3:return n(!0),e.next=6,t.prepare(o);case 6:u=e.sent,i(u),s(0),d=0,m=0;case 11:if(!(m<=u)){e.next=20;break}return e.t0=d,e.next=15,t.preprocess();case 15:d=e.t0+=e.sent,s(m/u);case 17:m++,e.next=11;break;case 20:a(d),r(0),h=1e4,p=0;case 24:if(!(p<Math.ceil(d/h))){e.next=33;break}return f=Math.min((p+1)*h,d),e.next=28,t.process(p*h,f);case 28:v=e.sent,r(f/d);case 30:p++,e.next=24;break;case 33:return e.next=35,t.clean();case 35:return n(!1),a(void 0),i(void 0),r(0),s(0),rt[l]=v,e.abrupt("return",v);case 42:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({workerInstance:n,setLoading:d,setCombinationsCount:p,setProgress:g,setInvestmentsCount:k,setPreprogress:C}),_=function(){var e=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.terminate(),t=be()(),e.next=4,t.clean();case 4:r(t),p(void 0),k(void 0),g(0),C(0),d(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{children:[Object(I.jsx)(Oe,{}),Object(I.jsx)(pe,{runInWoker:H,loading:l,result:G,setResult:function(e){E(void 0),V(void 0),N(e)},setError:function(e){E(void 0),V(void 0),q(e)}}),G&&Object(I.jsx)(Je,{runInWoker:H,loading:l,result:A,setResult:function(e){V(void 0),E(e)},setError:function(e){V(void 0),q(e)},firstRoundResult:G}),G&&A&&Object(I.jsx)(at,{firstRoundResult:G,secondRoundResult:A,runInWoker:H,loading:l,setResult:V,setError:q,result:B}),l&&Object(I.jsx)(we,{combinationsCount:v,progress:j,preprogress:T,investmentsCount:y,abort:_}),U&&Object(I.jsx)(Te,{message:U})]})},ot=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,257)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),i(e),s(e)}))};s.a.render(Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(st,{})}),document.getElementById("root")),ot()}},[[243,1,2]]]);
//# sourceMappingURL=main.a6dc8f28.chunk.js.map